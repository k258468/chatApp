(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();/**
* @vue/shared v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function $n(t){const e=Object.create(null);for(const r of t.split(","))e[r]=1;return r=>r in e}const se={},hr=[],nt=()=>{},fo=()=>!1,As=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),jn=t=>t.startsWith("onUpdate:"),Te=Object.assign,Un=(t,e)=>{const r=t.indexOf(e);r>-1&&t.splice(r,1)},Da=Object.prototype.hasOwnProperty,X=(t,e)=>Da.call(t,e),F=Array.isArray,dr=t=>Qr(t)==="[object Map]",yr=t=>Qr(t)==="[object Set]",li=t=>Qr(t)==="[object Date]",W=t=>typeof t=="function",ge=t=>typeof t=="string",at=t=>typeof t=="symbol",ae=t=>t!==null&&typeof t=="object",po=t=>(ae(t)||W(t))&&W(t.then)&&W(t.catch),go=Object.prototype.toString,Qr=t=>go.call(t),La=t=>Qr(t).slice(8,-1),vo=t=>Qr(t)==="[object Object]",Nn=t=>ge(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,xr=$n(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Os=t=>{const e=Object.create(null);return r=>e[r]||(e[r]=t(r))},Ba=/-\w/g,Ct=Os(t=>t.replace(Ba,e=>e.slice(1).toUpperCase())),Ma=/\B([A-Z])/g,Ht=Os(t=>t.replace(Ma,"-$1").toLowerCase()),mo=Os(t=>t.charAt(0).toUpperCase()+t.slice(1)),Fs=Os(t=>t?`on${mo(t)}`:""),xt=(t,e)=>!Object.is(t,e),hs=(t,...e)=>{for(let r=0;r<t.length;r++)t[r](...e)},wo=(t,e,r,s=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:s,value:r})},xs=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let ci;const Cs=()=>ci||(ci=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Is(t){if(F(t)){const e={};for(let r=0;r<t.length;r++){const s=t[r],n=ge(s)?Va(s):Is(s);if(n)for(const i in n)e[i]=n[i]}return e}else if(ge(t)||ae(t))return t}const qa=/;(?![^(]*\))/g,Fa=/:([^]+)/,Ka=/\/\*[^]*?\*\//g;function Va(t){const e={};return t.replace(Ka,"").split(qa).forEach(r=>{if(r){const s=r.split(Fa);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function Je(t){let e="";if(ge(t))e=t;else if(F(t))for(let r=0;r<t.length;r++){const s=Je(t[r]);s&&(e+=s+" ")}else if(ae(t))for(const r in t)t[r]&&(e+=r+" ");return e.trim()}const Wa="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Ha=$n(Wa);function _o(t){return!!t||t===""}function Ja(t,e){if(t.length!==e.length)return!1;let r=!0;for(let s=0;r&&s<t.length;s++)r=Yr(t[s],e[s]);return r}function Yr(t,e){if(t===e)return!0;let r=li(t),s=li(e);if(r||s)return r&&s?t.getTime()===e.getTime():!1;if(r=at(t),s=at(e),r||s)return t===e;if(r=F(t),s=F(e),r||s)return r&&s?Ja(t,e):!1;if(r=ae(t),s=ae(e),r||s){if(!r||!s)return!1;const n=Object.keys(t).length,i=Object.keys(e).length;if(n!==i)return!1;for(const o in t){const a=t.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!Yr(t[o],e[o]))return!1}}return String(t)===String(e)}function Dn(t,e){return t.findIndex(r=>Yr(r,e))}const yo=t=>!!(t&&t.__v_isRef===!0),re=t=>ge(t)?t:t==null?"":F(t)||ae(t)&&(t.toString===go||!W(t.toString))?yo(t)?re(t.value):JSON.stringify(t,bo,2):String(t),bo=(t,e)=>yo(e)?bo(t,e.value):dr(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((r,[s,n],i)=>(r[Ks(s,i)+" =>"]=n,r),{})}:yr(e)?{[`Set(${e.size})`]:[...e.values()].map(r=>Ks(r))}:at(e)?Ks(e):ae(e)&&!F(e)&&!vo(e)?String(e):e,Ks=(t,e="")=>{var r;return at(t)?`Symbol(${(r=t.description)!=null?r:e})`:t};/**
* @vue/reactivity v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let $e;class Ga{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=$e,!e&&$e&&(this.index=($e.scopes||($e.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,r;if(this.scopes)for(e=0,r=this.scopes.length;e<r;e++)this.scopes[e].pause();for(e=0,r=this.effects.length;e<r;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,r;if(this.scopes)for(e=0,r=this.scopes.length;e<r;e++)this.scopes[e].resume();for(e=0,r=this.effects.length;e<r;e++)this.effects[e].resume()}}run(e){if(this._active){const r=$e;try{return $e=this,e()}finally{$e=r}}}on(){++this._on===1&&(this.prevScope=$e,$e=this)}off(){this._on>0&&--this._on===0&&($e=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let r,s;for(r=0,s=this.effects.length;r<s;r++)this.effects[r].stop();for(this.effects.length=0,r=0,s=this.cleanups.length;r<s;r++)this.cleanups[r]();if(this.cleanups.length=0,this.scopes){for(r=0,s=this.scopes.length;r<s;r++)this.scopes[r].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const n=this.parent.scopes.pop();n&&n!==this&&(this.parent.scopes[this.index]=n,n.index=this.index)}this.parent=void 0}}}function za(){return $e}let oe;const Vs=new WeakSet;class So{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,$e&&$e.active&&$e.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Vs.has(this)&&(Vs.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||ko(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,ui(this),To(this);const e=oe,r=Ge;oe=this,Ge=!0;try{return this.fn()}finally{Ro(this),oe=e,Ge=r,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Mn(e);this.deps=this.depsTail=void 0,ui(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Vs.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){hn(this)&&this.run()}get dirty(){return hn(this)}}let Eo=0,Cr,Ir;function ko(t,e=!1){if(t.flags|=8,e){t.next=Ir,Ir=t;return}t.next=Cr,Cr=t}function Ln(){Eo++}function Bn(){if(--Eo>0)return;if(Ir){let e=Ir;for(Ir=void 0;e;){const r=e.next;e.next=void 0,e.flags&=-9,e=r}}let t;for(;Cr;){let e=Cr;for(Cr=void 0;e;){const r=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(s){t||(t=s)}e=r}}if(t)throw t}function To(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function Ro(t){let e,r=t.depsTail,s=r;for(;s;){const n=s.prevDep;s.version===-1?(s===r&&(r=n),Mn(s),Qa(s)):e=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=n}t.deps=e,t.depsTail=r}function hn(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(Ao(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function Ao(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===Lr)||(t.globalVersion=Lr,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!hn(t))))return;t.flags|=2;const e=t.dep,r=oe,s=Ge;oe=t,Ge=!0;try{To(t);const n=t.fn(t._value);(e.version===0||xt(n,t._value))&&(t.flags|=128,t._value=n,e.version++)}catch(n){throw e.version++,n}finally{oe=r,Ge=s,Ro(t),t.flags&=-3}}function Mn(t,e=!1){const{dep:r,prevSub:s,nextSub:n}=t;if(s&&(s.nextSub=n,t.prevSub=void 0),n&&(n.prevSub=s,t.nextSub=void 0),r.subs===t&&(r.subs=s,!s&&r.computed)){r.computed.flags&=-5;for(let i=r.computed.deps;i;i=i.nextDep)Mn(i,!0)}!e&&!--r.sc&&r.map&&r.map.delete(r.key)}function Qa(t){const{prevDep:e,nextDep:r}=t;e&&(e.nextDep=r,t.prevDep=void 0),r&&(r.prevDep=e,t.nextDep=void 0)}let Ge=!0;const Oo=[];function vt(){Oo.push(Ge),Ge=!1}function mt(){const t=Oo.pop();Ge=t===void 0?!0:t}function ui(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const r=oe;oe=void 0;try{e()}finally{oe=r}}}let Lr=0;class Ya{constructor(e,r){this.sub=e,this.dep=r,this.version=r.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class qn{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!oe||!Ge||oe===this.computed)return;let r=this.activeLink;if(r===void 0||r.sub!==oe)r=this.activeLink=new Ya(oe,this),oe.deps?(r.prevDep=oe.depsTail,oe.depsTail.nextDep=r,oe.depsTail=r):oe.deps=oe.depsTail=r,xo(r);else if(r.version===-1&&(r.version=this.version,r.nextDep)){const s=r.nextDep;s.prevDep=r.prevDep,r.prevDep&&(r.prevDep.nextDep=s),r.prevDep=oe.depsTail,r.nextDep=void 0,oe.depsTail.nextDep=r,oe.depsTail=r,oe.deps===r&&(oe.deps=s)}return r}trigger(e){this.version++,Lr++,this.notify(e)}notify(e){Ln();try{for(let r=this.subs;r;r=r.prevSub)r.sub.notify()&&r.sub.dep.notify()}finally{Bn()}}}function xo(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let s=e.deps;s;s=s.nextDep)xo(s)}const r=t.dep.subs;r!==t&&(t.prevSub=r,r&&(r.nextSub=t)),t.dep.subs=t}}const dn=new WeakMap,Vt=Symbol(""),fn=Symbol(""),Br=Symbol("");function Ee(t,e,r){if(Ge&&oe){let s=dn.get(t);s||dn.set(t,s=new Map);let n=s.get(r);n||(s.set(r,n=new qn),n.map=s,n.key=r),n.track()}}function ft(t,e,r,s,n,i){const o=dn.get(t);if(!o){Lr++;return}const a=l=>{l&&l.trigger()};if(Ln(),e==="clear")o.forEach(a);else{const l=F(t),c=l&&Nn(r);if(l&&r==="length"){const u=Number(s);o.forEach((h,p)=>{(p==="length"||p===Br||!at(p)&&p>=u)&&a(h)})}else switch((r!==void 0||o.has(void 0))&&a(o.get(r)),c&&a(o.get(Br)),e){case"add":l?c&&a(o.get("length")):(a(o.get(Vt)),dr(t)&&a(o.get(fn)));break;case"delete":l||(a(o.get(Vt)),dr(t)&&a(o.get(fn)));break;case"set":dr(t)&&a(o.get(Vt));break}}Bn()}function Yt(t){const e=Y(t);return e===t?e:(Ee(e,"iterate",Br),Ke(t)?e:e.map(ze))}function Ps(t){return Ee(t=Y(t),"iterate",Br),t}function Et(t,e){return wt(t)?Wt(t)?mr(ze(e)):mr(e):ze(e)}const Xa={__proto__:null,[Symbol.iterator](){return Ws(this,Symbol.iterator,t=>Et(this,t))},concat(...t){return Yt(this).concat(...t.map(e=>F(e)?Yt(e):e))},entries(){return Ws(this,"entries",t=>(t[1]=Et(this,t[1]),t))},every(t,e){return ut(this,"every",t,e,void 0,arguments)},filter(t,e){return ut(this,"filter",t,e,r=>r.map(s=>Et(this,s)),arguments)},find(t,e){return ut(this,"find",t,e,r=>Et(this,r),arguments)},findIndex(t,e){return ut(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return ut(this,"findLast",t,e,r=>Et(this,r),arguments)},findLastIndex(t,e){return ut(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return ut(this,"forEach",t,e,void 0,arguments)},includes(...t){return Hs(this,"includes",t)},indexOf(...t){return Hs(this,"indexOf",t)},join(t){return Yt(this).join(t)},lastIndexOf(...t){return Hs(this,"lastIndexOf",t)},map(t,e){return ut(this,"map",t,e,void 0,arguments)},pop(){return Tr(this,"pop")},push(...t){return Tr(this,"push",t)},reduce(t,...e){return hi(this,"reduce",t,e)},reduceRight(t,...e){return hi(this,"reduceRight",t,e)},shift(){return Tr(this,"shift")},some(t,e){return ut(this,"some",t,e,void 0,arguments)},splice(...t){return Tr(this,"splice",t)},toReversed(){return Yt(this).toReversed()},toSorted(t){return Yt(this).toSorted(t)},toSpliced(...t){return Yt(this).toSpliced(...t)},unshift(...t){return Tr(this,"unshift",t)},values(){return Ws(this,"values",t=>Et(this,t))}};function Ws(t,e,r){const s=Ps(t),n=s[e]();return s!==t&&!Ke(t)&&(n._next=n.next,n.next=()=>{const i=n._next();return i.done||(i.value=r(i.value)),i}),n}const Za=Array.prototype;function ut(t,e,r,s,n,i){const o=Ps(t),a=o!==t&&!Ke(t),l=o[e];if(l!==Za[e]){const h=l.apply(t,i);return a?ze(h):h}let c=r;o!==t&&(a?c=function(h,p){return r.call(this,Et(t,h),p,t)}:r.length>2&&(c=function(h,p){return r.call(this,h,p,t)}));const u=l.call(o,c,s);return a&&n?n(u):u}function hi(t,e,r,s){const n=Ps(t);let i=r;return n!==t&&(Ke(t)?r.length>3&&(i=function(o,a,l){return r.call(this,o,a,l,t)}):i=function(o,a,l){return r.call(this,o,Et(t,a),l,t)}),n[e](i,...s)}function Hs(t,e,r){const s=Y(t);Ee(s,"iterate",Br);const n=s[e](...r);return(n===-1||n===!1)&&Wn(r[0])?(r[0]=Y(r[0]),s[e](...r)):n}function Tr(t,e,r=[]){vt(),Ln();const s=Y(t)[e].apply(t,r);return Bn(),mt(),s}const el=$n("__proto__,__v_isRef,__isVue"),Co=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(at));function tl(t){at(t)||(t=String(t));const e=Y(this);return Ee(e,"has",t),e.hasOwnProperty(t)}class Io{constructor(e=!1,r=!1){this._isReadonly=e,this._isShallow=r}get(e,r,s){if(r==="__v_skip")return e.__v_skip;const n=this._isReadonly,i=this._isShallow;if(r==="__v_isReactive")return!n;if(r==="__v_isReadonly")return n;if(r==="__v_isShallow")return i;if(r==="__v_raw")return s===(n?i?hl:Uo:i?jo:$o).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(s)?e:void 0;const o=F(e);if(!n){let l;if(o&&(l=Xa[r]))return l;if(r==="hasOwnProperty")return tl}const a=Reflect.get(e,r,ke(e)?e:s);if((at(r)?Co.has(r):el(r))||(n||Ee(e,"get",r),i))return a;if(ke(a)){const l=o&&Nn(r)?a:a.value;return n&&ae(l)?gn(l):l}return ae(a)?n?gn(a):Kn(a):a}}class Po extends Io{constructor(e=!1){super(!1,e)}set(e,r,s,n){let i=e[r];const o=F(e)&&Nn(r);if(!this._isShallow){const c=wt(i);if(!Ke(s)&&!wt(s)&&(i=Y(i),s=Y(s)),!o&&ke(i)&&!ke(s))return c||(i.value=s),!0}const a=o?Number(r)<e.length:X(e,r),l=Reflect.set(e,r,s,ke(e)?e:n);return e===Y(n)&&(a?xt(s,i)&&ft(e,"set",r,s):ft(e,"add",r,s)),l}deleteProperty(e,r){const s=X(e,r);e[r];const n=Reflect.deleteProperty(e,r);return n&&s&&ft(e,"delete",r,void 0),n}has(e,r){const s=Reflect.has(e,r);return(!at(r)||!Co.has(r))&&Ee(e,"has",r),s}ownKeys(e){return Ee(e,"iterate",F(e)?"length":Vt),Reflect.ownKeys(e)}}class rl extends Io{constructor(e=!1){super(!0,e)}set(e,r){return!0}deleteProperty(e,r){return!0}}const sl=new Po,nl=new rl,il=new Po(!0);const pn=t=>t,rs=t=>Reflect.getPrototypeOf(t);function ol(t,e,r){return function(...s){const n=this.__v_raw,i=Y(n),o=dr(i),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,c=n[t](...s),u=r?pn:e?mr:ze;return!e&&Ee(i,"iterate",l?fn:Vt),{next(){const{value:h,done:p}=c.next();return p?{value:h,done:p}:{value:a?[u(h[0]),u(h[1])]:u(h),done:p}},[Symbol.iterator](){return this}}}}function ss(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function al(t,e){const r={get(n){const i=this.__v_raw,o=Y(i),a=Y(n);t||(xt(n,a)&&Ee(o,"get",n),Ee(o,"get",a));const{has:l}=rs(o),c=e?pn:t?mr:ze;if(l.call(o,n))return c(i.get(n));if(l.call(o,a))return c(i.get(a));i!==o&&i.get(n)},get size(){const n=this.__v_raw;return!t&&Ee(Y(n),"iterate",Vt),n.size},has(n){const i=this.__v_raw,o=Y(i),a=Y(n);return t||(xt(n,a)&&Ee(o,"has",n),Ee(o,"has",a)),n===a?i.has(n):i.has(n)||i.has(a)},forEach(n,i){const o=this,a=o.__v_raw,l=Y(a),c=e?pn:t?mr:ze;return!t&&Ee(l,"iterate",Vt),a.forEach((u,h)=>n.call(i,c(u),c(h),o))}};return Te(r,t?{add:ss("add"),set:ss("set"),delete:ss("delete"),clear:ss("clear")}:{add(n){!e&&!Ke(n)&&!wt(n)&&(n=Y(n));const i=Y(this);return rs(i).has.call(i,n)||(i.add(n),ft(i,"add",n,n)),this},set(n,i){!e&&!Ke(i)&&!wt(i)&&(i=Y(i));const o=Y(this),{has:a,get:l}=rs(o);let c=a.call(o,n);c||(n=Y(n),c=a.call(o,n));const u=l.call(o,n);return o.set(n,i),c?xt(i,u)&&ft(o,"set",n,i):ft(o,"add",n,i),this},delete(n){const i=Y(this),{has:o,get:a}=rs(i);let l=o.call(i,n);l||(n=Y(n),l=o.call(i,n)),a&&a.call(i,n);const c=i.delete(n);return l&&ft(i,"delete",n,void 0),c},clear(){const n=Y(this),i=n.size!==0,o=n.clear();return i&&ft(n,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(n=>{r[n]=ol(n,t,e)}),r}function Fn(t,e){const r=al(t,e);return(s,n,i)=>n==="__v_isReactive"?!t:n==="__v_isReadonly"?t:n==="__v_raw"?s:Reflect.get(X(r,n)&&n in s?r:s,n,i)}const ll={get:Fn(!1,!1)},cl={get:Fn(!1,!0)},ul={get:Fn(!0,!1)};const $o=new WeakMap,jo=new WeakMap,Uo=new WeakMap,hl=new WeakMap;function dl(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function fl(t){return t.__v_skip||!Object.isExtensible(t)?0:dl(La(t))}function Kn(t){return wt(t)?t:Vn(t,!1,sl,ll,$o)}function pl(t){return Vn(t,!1,il,cl,jo)}function gn(t){return Vn(t,!0,nl,ul,Uo)}function Vn(t,e,r,s,n){if(!ae(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=fl(t);if(i===0)return t;const o=n.get(t);if(o)return o;const a=new Proxy(t,i===2?s:r);return n.set(t,a),a}function Wt(t){return wt(t)?Wt(t.__v_raw):!!(t&&t.__v_isReactive)}function wt(t){return!!(t&&t.__v_isReadonly)}function Ke(t){return!!(t&&t.__v_isShallow)}function Wn(t){return t?!!t.__v_raw:!1}function Y(t){const e=t&&t.__v_raw;return e?Y(e):t}function gl(t){return!X(t,"__v_skip")&&Object.isExtensible(t)&&wo(t,"__v_skip",!0),t}const ze=t=>ae(t)?Kn(t):t,mr=t=>ae(t)?gn(t):t;function ke(t){return t?t.__v_isRef===!0:!1}function ce(t){return vl(t,!1)}function vl(t,e){return ke(t)?t:new ml(t,e)}class ml{constructor(e,r){this.dep=new qn,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=r?e:Y(e),this._value=r?e:ze(e),this.__v_isShallow=r}get value(){return this.dep.track(),this._value}set value(e){const r=this._rawValue,s=this.__v_isShallow||Ke(e)||wt(e);e=s?e:Y(e),xt(e,r)&&(this._rawValue=e,this._value=s?e:ze(e),this.dep.trigger())}}function wl(t){return ke(t)?t.value:t}const _l={get:(t,e,r)=>e==="__v_raw"?t:wl(Reflect.get(t,e,r)),set:(t,e,r,s)=>{const n=t[e];return ke(n)&&!ke(r)?(n.value=r,!0):Reflect.set(t,e,r,s)}};function No(t){return Wt(t)?t:new Proxy(t,_l)}class yl{constructor(e,r,s){this.fn=e,this.setter=r,this._value=void 0,this.dep=new qn(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Lr-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!r,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&oe!==this)return ko(this,!0),!0}get value(){const e=this.dep.track();return Ao(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function bl(t,e,r=!1){let s,n;return W(t)?s=t:(s=t.get,n=t.set),new yl(s,n,r)}const ns={},ms=new WeakMap;let Bt;function Sl(t,e=!1,r=Bt){if(r){let s=ms.get(r);s||ms.set(r,s=[]),s.push(t)}}function El(t,e,r=se){const{immediate:s,deep:n,once:i,scheduler:o,augmentJob:a,call:l}=r,c=A=>n?A:Ke(A)||n===!1||n===0?pt(A,1):pt(A);let u,h,p,d,v=!1,b=!1;if(ke(t)?(h=()=>t.value,v=Ke(t)):Wt(t)?(h=()=>c(t),v=!0):F(t)?(b=!0,v=t.some(A=>Wt(A)||Ke(A)),h=()=>t.map(A=>{if(ke(A))return A.value;if(Wt(A))return c(A);if(W(A))return l?l(A,2):A()})):W(t)?e?h=l?()=>l(t,2):t:h=()=>{if(p){vt();try{p()}finally{mt()}}const A=Bt;Bt=u;try{return l?l(t,3,[d]):t(d)}finally{Bt=A}}:h=nt,e&&n){const A=h,x=n===!0?1/0:n;h=()=>pt(A(),x)}const O=za(),y=()=>{u.stop(),O&&O.active&&Un(O.effects,u)};if(i&&e){const A=e;e=(...x)=>{A(...x),y()}}let k=b?new Array(t.length).fill(ns):ns;const w=A=>{if(!(!(u.flags&1)||!u.dirty&&!A))if(e){const x=u.run();if(n||v||(b?x.some((J,Q)=>xt(J,k[Q])):xt(x,k))){p&&p();const J=Bt;Bt=u;try{const Q=[x,k===ns?void 0:b&&k[0]===ns?[]:k,d];k=x,l?l(e,3,Q):e(...Q)}finally{Bt=J}}}else u.run()};return a&&a(w),u=new So(h),u.scheduler=o?()=>o(w,!1):w,d=A=>Sl(A,!1,u),p=u.onStop=()=>{const A=ms.get(u);if(A){if(l)l(A,4);else for(const x of A)x();ms.delete(u)}},e?s?w(!0):k=u.run():o?o(w.bind(null,!0),!0):u.run(),y.pause=u.pause.bind(u),y.resume=u.resume.bind(u),y.stop=y,y}function pt(t,e=1/0,r){if(e<=0||!ae(t)||t.__v_skip||(r=r||new Map,(r.get(t)||0)>=e))return t;if(r.set(t,e),e--,ke(t))pt(t.value,e,r);else if(F(t))for(let s=0;s<t.length;s++)pt(t[s],e,r);else if(yr(t)||dr(t))t.forEach(s=>{pt(s,e,r)});else if(vo(t)){for(const s in t)pt(t[s],e,r);for(const s of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,s)&&pt(t[s],e,r)}return t}/**
* @vue/runtime-core v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Xr(t,e,r,s){try{return s?t(...s):t()}catch(n){$s(n,e,r)}}function lt(t,e,r,s){if(W(t)){const n=Xr(t,e,r,s);return n&&po(n)&&n.catch(i=>{$s(i,e,r)}),n}if(F(t)){const n=[];for(let i=0;i<t.length;i++)n.push(lt(t[i],e,r,s));return n}}function $s(t,e,r,s=!0){const n=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||se;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${r}`;for(;a;){const u=a.ec;if(u){for(let h=0;h<u.length;h++)if(u[h](t,l,c)===!1)return}a=a.parent}if(i){vt(),Xr(i,null,10,[t,l,c]),mt();return}}kl(t,r,n,s,o)}function kl(t,e,r,s=!0,n=!1){if(n)throw t;console.error(t)}const Oe=[];let rt=-1;const fr=[];let kt=null,ir=0;const Do=Promise.resolve();let ws=null;function Lo(t){const e=ws||Do;return t?e.then(this?t.bind(this):t):e}function Tl(t){let e=rt+1,r=Oe.length;for(;e<r;){const s=e+r>>>1,n=Oe[s],i=Mr(n);i<t||i===t&&n.flags&2?e=s+1:r=s}return e}function Hn(t){if(!(t.flags&1)){const e=Mr(t),r=Oe[Oe.length-1];!r||!(t.flags&2)&&e>=Mr(r)?Oe.push(t):Oe.splice(Tl(e),0,t),t.flags|=1,Bo()}}function Bo(){ws||(ws=Do.then(qo))}function Rl(t){F(t)?fr.push(...t):kt&&t.id===-1?kt.splice(ir+1,0,t):t.flags&1||(fr.push(t),t.flags|=1),Bo()}function di(t,e,r=rt+1){for(;r<Oe.length;r++){const s=Oe[r];if(s&&s.flags&2){if(t&&s.id!==t.uid)continue;Oe.splice(r,1),r--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function Mo(t){if(fr.length){const e=[...new Set(fr)].sort((r,s)=>Mr(r)-Mr(s));if(fr.length=0,kt){kt.push(...e);return}for(kt=e,ir=0;ir<kt.length;ir++){const r=kt[ir];r.flags&4&&(r.flags&=-2),r.flags&8||r(),r.flags&=-2}kt=null,ir=0}}const Mr=t=>t.id==null?t.flags&2?-1:1/0:t.id;function qo(t){try{for(rt=0;rt<Oe.length;rt++){const e=Oe[rt];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Xr(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;rt<Oe.length;rt++){const e=Oe[rt];e&&(e.flags&=-2)}rt=-1,Oe.length=0,Mo(),ws=null,(Oe.length||fr.length)&&qo()}}let Fe=null,Fo=null;function _s(t){const e=Fe;return Fe=t,Fo=t&&t.type.__scopeId||null,e}function Al(t,e=Fe,r){if(!e||t._n)return t;const s=(...n)=>{s._d&&Si(-1);const i=_s(e);let o;try{o=t(...n)}finally{_s(i),s._d&&Si(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function Me(t,e){if(Fe===null)return t;const r=Ds(Fe),s=t.dirs||(t.dirs=[]);for(let n=0;n<e.length;n++){let[i,o,a,l=se]=e[n];i&&(W(i)&&(i={mounted:i,updated:i}),i.deep&&pt(o),s.push({dir:i,instance:r,value:o,oldValue:void 0,arg:a,modifiers:l}))}return t}function jt(t,e,r,s){const n=t.dirs,i=e&&e.dirs;for(let o=0;o<n.length;o++){const a=n[o];i&&(a.oldValue=i[o].value);let l=a.dir[s];l&&(vt(),lt(l,r,8,[t.el,a,t,e]),mt())}}function Ol(t,e){if(Ce){let r=Ce.provides;const s=Ce.parent&&Ce.parent.provides;s===r&&(r=Ce.provides=Object.create(s)),r[t]=e}}function ds(t,e,r=!1){const s=Rc();if(s||pr){let n=pr?pr._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(n&&t in n)return n[t];if(arguments.length>1)return r&&W(e)?e.call(s&&s.proxy):e}}const xl=Symbol.for("v-scx"),Cl=()=>ds(xl);function fs(t,e,r){return Ko(t,e,r)}function Ko(t,e,r=se){const{immediate:s,deep:n,flush:i,once:o}=r,a=Te({},r),l=e&&s||!e&&i!=="post";let c;if(Fr){if(i==="sync"){const d=Cl();c=d.__watcherHandles||(d.__watcherHandles=[])}else if(!l){const d=()=>{};return d.stop=nt,d.resume=nt,d.pause=nt,d}}const u=Ce;a.call=(d,v,b)=>lt(d,u,v,b);let h=!1;i==="post"?a.scheduler=d=>{De(d,u&&u.suspense)}:i!=="sync"&&(h=!0,a.scheduler=(d,v)=>{v?d():Hn(d)}),a.augmentJob=d=>{e&&(d.flags|=4),h&&(d.flags|=2,u&&(d.id=u.uid,d.i=u))};const p=El(t,e,a);return Fr&&(c?c.push(p):l&&p()),p}function Il(t,e,r){const s=this.proxy,n=ge(t)?t.includes(".")?Vo(s,t):()=>s[t]:t.bind(s,s);let i;W(e)?i=e:(i=e.handler,r=e);const o=Zr(this),a=Ko(n,i.bind(s),r);return o(),a}function Vo(t,e){const r=e.split(".");return()=>{let s=t;for(let n=0;n<r.length&&s;n++)s=s[r[n]];return s}}const Pl=Symbol("_vte"),$l=t=>t.__isTeleport,jl=Symbol("_leaveCb");function Jn(t,e){t.shapeFlag&6&&t.component?(t.transition=e,Jn(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Jt(t,e){return W(t)?Te({name:t.name},e,{setup:t}):t}function Wo(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}const ys=new WeakMap;function Pr(t,e,r,s,n=!1){if(F(t)){t.forEach((v,b)=>Pr(v,e&&(F(e)?e[b]:e),r,s,n));return}if($r(s)&&!n){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&Pr(t,e,r,s.component.subTree);return}const i=s.shapeFlag&4?Ds(s.component):s.el,o=n?null:i,{i:a,r:l}=t,c=e&&e.r,u=a.refs===se?a.refs={}:a.refs,h=a.setupState,p=Y(h),d=h===se?fo:v=>X(p,v);if(c!=null&&c!==l){if(fi(e),ge(c))u[c]=null,d(c)&&(h[c]=null);else if(ke(c)){c.value=null;const v=e;v.k&&(u[v.k]=null)}}if(W(l))Xr(l,a,12,[o,u]);else{const v=ge(l),b=ke(l);if(v||b){const O=()=>{if(t.f){const y=v?d(l)?h[l]:u[l]:l.value;if(n)F(y)&&Un(y,i);else if(F(y))y.includes(i)||y.push(i);else if(v)u[l]=[i],d(l)&&(h[l]=u[l]);else{const k=[i];l.value=k,t.k&&(u[t.k]=k)}}else v?(u[l]=o,d(l)&&(h[l]=o)):b&&(l.value=o,t.k&&(u[t.k]=o))};if(o){const y=()=>{O(),ys.delete(t)};y.id=-1,ys.set(t,y),De(y,r)}else fi(t),O()}}}function fi(t){const e=ys.get(t);e&&(e.flags|=8,ys.delete(t))}Cs().requestIdleCallback;Cs().cancelIdleCallback;const $r=t=>!!t.type.__asyncLoader,Ho=t=>t.type.__isKeepAlive;function Ul(t,e){Jo(t,"a",e)}function Nl(t,e){Jo(t,"da",e)}function Jo(t,e,r=Ce){const s=t.__wdc||(t.__wdc=()=>{let n=r;for(;n;){if(n.isDeactivated)return;n=n.parent}return t()});if(js(e,s,r),r){let n=r.parent;for(;n&&n.parent;)Ho(n.parent.vnode)&&Dl(s,e,r,n),n=n.parent}}function Dl(t,e,r,s){const n=js(e,t,s,!0);Gn(()=>{Un(s[e],n)},r)}function js(t,e,r=Ce,s=!1){if(r){const n=r[t]||(r[t]=[]),i=e.__weh||(e.__weh=(...o)=>{vt();const a=Zr(r),l=lt(e,r,t,o);return a(),mt(),l});return s?n.unshift(i):n.push(i),i}}const _t=t=>(e,r=Ce)=>{(!Fr||t==="sp")&&js(t,(...s)=>e(...s),r)},Ll=_t("bm"),Go=_t("m"),Bl=_t("bu"),Ml=_t("u"),ql=_t("bum"),Gn=_t("um"),Fl=_t("sp"),Kl=_t("rtg"),Vl=_t("rtc");function Wl(t,e=Ce){js("ec",t,e)}const Hl=Symbol.for("v-ndc");function bs(t,e,r,s){let n;const i=r,o=F(t);if(o||ge(t)){const a=o&&Wt(t);let l=!1,c=!1;a&&(l=!Ke(t),c=wt(t),t=Ps(t)),n=new Array(t.length);for(let u=0,h=t.length;u<h;u++)n[u]=e(l?c?mr(ze(t[u])):ze(t[u]):t[u],u,void 0,i)}else if(typeof t=="number"){n=new Array(t);for(let a=0;a<t;a++)n[a]=e(a+1,a,void 0,i)}else if(ae(t))if(t[Symbol.iterator])n=Array.from(t,(a,l)=>e(a,l,void 0,i));else{const a=Object.keys(t);n=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const u=a[l];n[l]=e(t[u],u,l,i)}}else n=[];return n}const vn=t=>t?pa(t)?Ds(t):vn(t.parent):null,jr=Te(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>vn(t.parent),$root:t=>vn(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>Qo(t),$forceUpdate:t=>t.f||(t.f=()=>{Hn(t.update)}),$nextTick:t=>t.n||(t.n=Lo.bind(t.proxy)),$watch:t=>Il.bind(t)}),Js=(t,e)=>t!==se&&!t.__isScriptSetup&&X(t,e),Jl={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:r,setupState:s,data:n,props:i,accessCache:o,type:a,appContext:l}=t;if(e[0]!=="$"){const p=o[e];if(p!==void 0)switch(p){case 1:return s[e];case 2:return n[e];case 4:return r[e];case 3:return i[e]}else{if(Js(s,e))return o[e]=1,s[e];if(n!==se&&X(n,e))return o[e]=2,n[e];if(X(i,e))return o[e]=3,i[e];if(r!==se&&X(r,e))return o[e]=4,r[e];mn&&(o[e]=0)}}const c=jr[e];let u,h;if(c)return e==="$attrs"&&Ee(t.attrs,"get",""),c(t);if((u=a.__cssModules)&&(u=u[e]))return u;if(r!==se&&X(r,e))return o[e]=4,r[e];if(h=l.config.globalProperties,X(h,e))return h[e]},set({_:t},e,r){const{data:s,setupState:n,ctx:i}=t;return Js(n,e)?(n[e]=r,!0):s!==se&&X(s,e)?(s[e]=r,!0):X(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=r,!0)},has({_:{data:t,setupState:e,accessCache:r,ctx:s,appContext:n,props:i,type:o}},a){let l;return!!(r[a]||t!==se&&a[0]!=="$"&&X(t,a)||Js(e,a)||X(i,a)||X(s,a)||X(jr,a)||X(n.config.globalProperties,a)||(l=o.__cssModules)&&l[a])},defineProperty(t,e,r){return r.get!=null?t._.accessCache[e]=0:X(r,"value")&&this.set(t,e,r.value,null),Reflect.defineProperty(t,e,r)}};function pi(t){return F(t)?t.reduce((e,r)=>(e[r]=null,e),{}):t}let mn=!0;function Gl(t){const e=Qo(t),r=t.proxy,s=t.ctx;mn=!1,e.beforeCreate&&gi(e.beforeCreate,t,"bc");const{data:n,computed:i,methods:o,watch:a,provide:l,inject:c,created:u,beforeMount:h,mounted:p,beforeUpdate:d,updated:v,activated:b,deactivated:O,beforeDestroy:y,beforeUnmount:k,destroyed:w,unmounted:A,render:x,renderTracked:J,renderTriggered:Q,errorCaptured:ve,serverPrefetch:be,expose:ct,inheritAttrs:Pt,components:Gt,directives:zt,filters:Sr}=e;if(c&&zl(c,s,null),o)for(const le in o){const Z=o[le];W(Z)&&(s[le]=Z.bind(r))}if(n){const le=n.call(r,r);ae(le)&&(t.data=Kn(le))}if(mn=!0,i)for(const le in i){const Z=i[le],P=W(Z)?Z.bind(r,r):W(Z.get)?Z.get.bind(r,r):nt,j=!W(Z)&&W(Z.set)?Z.set.bind(r):nt,q=gr({get:P,set:j});Object.defineProperty(s,le,{enumerable:!0,configurable:!0,get:()=>q.value,set:z=>q.value=z})}if(a)for(const le in a)zo(a[le],s,r,le);if(l){const le=W(l)?l.call(r):l;Reflect.ownKeys(le).forEach(Z=>{Ol(Z,le[Z])})}u&&gi(u,t,"c");function de(le,Z){F(Z)?Z.forEach(P=>le(P.bind(r))):Z&&le(Z.bind(r))}if(de(Ll,h),de(Go,p),de(Bl,d),de(Ml,v),de(Ul,b),de(Nl,O),de(Wl,ve),de(Vl,J),de(Kl,Q),de(ql,k),de(Gn,A),de(Fl,be),F(ct))if(ct.length){const le=t.exposed||(t.exposed={});ct.forEach(Z=>{Object.defineProperty(le,Z,{get:()=>r[Z],set:P=>r[Z]=P,enumerable:!0})})}else t.exposed||(t.exposed={});x&&t.render===nt&&(t.render=x),Pt!=null&&(t.inheritAttrs=Pt),Gt&&(t.components=Gt),zt&&(t.directives=zt),be&&Wo(t)}function zl(t,e,r=nt){F(t)&&(t=wn(t));for(const s in t){const n=t[s];let i;ae(n)?"default"in n?i=ds(n.from||s,n.default,!0):i=ds(n.from||s):i=ds(n),ke(i)?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[s]=i}}function gi(t,e,r){lt(F(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,r)}function zo(t,e,r,s){let n=s.includes(".")?Vo(r,s):()=>r[s];if(ge(t)){const i=e[t];W(i)&&fs(n,i)}else if(W(t))fs(n,t.bind(r));else if(ae(t))if(F(t))t.forEach(i=>zo(i,e,r,s));else{const i=W(t.handler)?t.handler.bind(r):e[t.handler];W(i)&&fs(n,i,t)}}function Qo(t){const e=t.type,{mixins:r,extends:s}=e,{mixins:n,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,a=i.get(e);let l;return a?l=a:!n.length&&!r&&!s?l=e:(l={},n.length&&n.forEach(c=>Ss(l,c,o,!0)),Ss(l,e,o)),ae(e)&&i.set(e,l),l}function Ss(t,e,r,s=!1){const{mixins:n,extends:i}=e;i&&Ss(t,i,r,!0),n&&n.forEach(o=>Ss(t,o,r,!0));for(const o in e)if(!(s&&o==="expose")){const a=Ql[o]||r&&r[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const Ql={data:vi,props:mi,emits:mi,methods:Ar,computed:Ar,beforeCreate:Ae,created:Ae,beforeMount:Ae,mounted:Ae,beforeUpdate:Ae,updated:Ae,beforeDestroy:Ae,beforeUnmount:Ae,destroyed:Ae,unmounted:Ae,activated:Ae,deactivated:Ae,errorCaptured:Ae,serverPrefetch:Ae,components:Ar,directives:Ar,watch:Xl,provide:vi,inject:Yl};function vi(t,e){return e?t?function(){return Te(W(t)?t.call(this,this):t,W(e)?e.call(this,this):e)}:e:t}function Yl(t,e){return Ar(wn(t),wn(e))}function wn(t){if(F(t)){const e={};for(let r=0;r<t.length;r++)e[t[r]]=t[r];return e}return t}function Ae(t,e){return t?[...new Set([].concat(t,e))]:e}function Ar(t,e){return t?Te(Object.create(null),t,e):e}function mi(t,e){return t?F(t)&&F(e)?[...new Set([...t,...e])]:Te(Object.create(null),pi(t),pi(e??{})):e}function Xl(t,e){if(!t)return e;if(!e)return t;const r=Te(Object.create(null),t);for(const s in e)r[s]=Ae(t[s],e[s]);return r}function Yo(){return{app:null,config:{isNativeTag:fo,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Zl=0;function ec(t,e){return function(s,n=null){W(s)||(s=Te({},s)),n!=null&&!ae(n)&&(n=null);const i=Yo(),o=new WeakSet,a=[];let l=!1;const c=i.app={_uid:Zl++,_component:s,_props:n,_container:null,_context:i,_instance:null,version:Pc,get config(){return i.config},set config(u){},use(u,...h){return o.has(u)||(u&&W(u.install)?(o.add(u),u.install(c,...h)):W(u)&&(o.add(u),u(c,...h))),c},mixin(u){return i.mixins.includes(u)||i.mixins.push(u),c},component(u,h){return h?(i.components[u]=h,c):i.components[u]},directive(u,h){return h?(i.directives[u]=h,c):i.directives[u]},mount(u,h,p){if(!l){const d=c._ceVNode||it(s,n);return d.appContext=i,p===!0?p="svg":p===!1&&(p=void 0),t(d,u,p),l=!0,c._container=u,u.__vue_app__=c,Ds(d.component)}},onUnmount(u){a.push(u)},unmount(){l&&(lt(a,c._instance,16),t(null,c._container),delete c._container.__vue_app__)},provide(u,h){return i.provides[u]=h,c},runWithContext(u){const h=pr;pr=c;try{return u()}finally{pr=h}}};return c}}let pr=null;const tc=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${Ct(e)}Modifiers`]||t[`${Ht(e)}Modifiers`];function rc(t,e,...r){if(t.isUnmounted)return;const s=t.vnode.props||se;let n=r;const i=e.startsWith("update:"),o=i&&tc(s,e.slice(7));o&&(o.trim&&(n=r.map(u=>ge(u)?u.trim():u)),o.number&&(n=r.map(xs)));let a,l=s[a=Fs(e)]||s[a=Fs(Ct(e))];!l&&i&&(l=s[a=Fs(Ht(e))]),l&&lt(l,t,6,n);const c=s[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,lt(c,t,6,n)}}const sc=new WeakMap;function Xo(t,e,r=!1){const s=r?sc:e.emitsCache,n=s.get(t);if(n!==void 0)return n;const i=t.emits;let o={},a=!1;if(!W(t)){const l=c=>{const u=Xo(c,e,!0);u&&(a=!0,Te(o,u))};!r&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!i&&!a?(ae(t)&&s.set(t,null),null):(F(i)?i.forEach(l=>o[l]=null):Te(o,i),ae(t)&&s.set(t,o),o)}function Us(t,e){return!t||!As(e)?!1:(e=e.slice(2).replace(/Once$/,""),X(t,e[0].toLowerCase()+e.slice(1))||X(t,Ht(e))||X(t,e))}function wi(t){const{type:e,vnode:r,proxy:s,withProxy:n,propsOptions:[i],slots:o,attrs:a,emit:l,render:c,renderCache:u,props:h,data:p,setupState:d,ctx:v,inheritAttrs:b}=t,O=_s(t);let y,k;try{if(r.shapeFlag&4){const A=n||s,x=A;y=st(c.call(x,A,u,h,d,p,v)),k=a}else{const A=e;y=st(A.length>1?A(h,{attrs:a,slots:o,emit:l}):A(h,null)),k=e.props?a:nc(a)}}catch(A){Ur.length=0,$s(A,t,1),y=it(It)}let w=y;if(k&&b!==!1){const A=Object.keys(k),{shapeFlag:x}=w;A.length&&x&7&&(i&&A.some(jn)&&(k=ic(k,i)),w=wr(w,k,!1,!0))}return r.dirs&&(w=wr(w,null,!1,!0),w.dirs=w.dirs?w.dirs.concat(r.dirs):r.dirs),r.transition&&Jn(w,r.transition),y=w,_s(O),y}const nc=t=>{let e;for(const r in t)(r==="class"||r==="style"||As(r))&&((e||(e={}))[r]=t[r]);return e},ic=(t,e)=>{const r={};for(const s in t)(!jn(s)||!(s.slice(9)in e))&&(r[s]=t[s]);return r};function oc(t,e,r){const{props:s,children:n,component:i}=t,{props:o,children:a,patchFlag:l}=e,c=i.emitsOptions;if(e.dirs||e.transition)return!0;if(r&&l>=0){if(l&1024)return!0;if(l&16)return s?_i(s,o,c):!!o;if(l&8){const u=e.dynamicProps;for(let h=0;h<u.length;h++){const p=u[h];if(o[p]!==s[p]&&!Us(c,p))return!0}}}else return(n||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?_i(s,o,c):!0:!!o;return!1}function _i(t,e,r){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let n=0;n<s.length;n++){const i=s[n];if(e[i]!==t[i]&&!Us(r,i))return!0}return!1}function ac({vnode:t,parent:e},r){for(;e;){const s=e.subTree;if(s.suspense&&s.suspense.activeBranch===t&&(s.el=t.el),s===t)(t=e.vnode).el=r,e=e.parent;else break}}const Zo={},ea=()=>Object.create(Zo),ta=t=>Object.getPrototypeOf(t)===Zo;function lc(t,e,r,s=!1){const n={},i=ea();t.propsDefaults=Object.create(null),ra(t,e,n,i);for(const o in t.propsOptions[0])o in n||(n[o]=void 0);r?t.props=s?n:pl(n):t.type.props?t.props=n:t.props=i,t.attrs=i}function cc(t,e,r,s){const{props:n,attrs:i,vnode:{patchFlag:o}}=t,a=Y(n),[l]=t.propsOptions;let c=!1;if((s||o>0)&&!(o&16)){if(o&8){const u=t.vnode.dynamicProps;for(let h=0;h<u.length;h++){let p=u[h];if(Us(t.emitsOptions,p))continue;const d=e[p];if(l)if(X(i,p))d!==i[p]&&(i[p]=d,c=!0);else{const v=Ct(p);n[v]=_n(l,a,v,d,t,!1)}else d!==i[p]&&(i[p]=d,c=!0)}}}else{ra(t,e,n,i)&&(c=!0);let u;for(const h in a)(!e||!X(e,h)&&((u=Ht(h))===h||!X(e,u)))&&(l?r&&(r[h]!==void 0||r[u]!==void 0)&&(n[h]=_n(l,a,h,void 0,t,!0)):delete n[h]);if(i!==a)for(const h in i)(!e||!X(e,h))&&(delete i[h],c=!0)}c&&ft(t.attrs,"set","")}function ra(t,e,r,s){const[n,i]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(xr(l))continue;const c=e[l];let u;n&&X(n,u=Ct(l))?!i||!i.includes(u)?r[u]=c:(a||(a={}))[u]=c:Us(t.emitsOptions,l)||(!(l in s)||c!==s[l])&&(s[l]=c,o=!0)}if(i){const l=Y(r),c=a||se;for(let u=0;u<i.length;u++){const h=i[u];r[h]=_n(n,l,h,c[h],t,!X(c,h))}}return o}function _n(t,e,r,s,n,i){const o=t[r];if(o!=null){const a=X(o,"default");if(a&&s===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&W(l)){const{propsDefaults:c}=n;if(r in c)s=c[r];else{const u=Zr(n);s=c[r]=l.call(null,e),u()}}else s=l;n.ce&&n.ce._setProp(r,s)}o[0]&&(i&&!a?s=!1:o[1]&&(s===""||s===Ht(r))&&(s=!0))}return s}const uc=new WeakMap;function sa(t,e,r=!1){const s=r?uc:e.propsCache,n=s.get(t);if(n)return n;const i=t.props,o={},a=[];let l=!1;if(!W(t)){const u=h=>{l=!0;const[p,d]=sa(h,e,!0);Te(o,p),d&&a.push(...d)};!r&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!i&&!l)return ae(t)&&s.set(t,hr),hr;if(F(i))for(let u=0;u<i.length;u++){const h=Ct(i[u]);yi(h)&&(o[h]=se)}else if(i)for(const u in i){const h=Ct(u);if(yi(h)){const p=i[u],d=o[h]=F(p)||W(p)?{type:p}:Te({},p),v=d.type;let b=!1,O=!0;if(F(v))for(let y=0;y<v.length;++y){const k=v[y],w=W(k)&&k.name;if(w==="Boolean"){b=!0;break}else w==="String"&&(O=!1)}else b=W(v)&&v.name==="Boolean";d[0]=b,d[1]=O,(b||X(d,"default"))&&a.push(h)}}const c=[o,a];return ae(t)&&s.set(t,c),c}function yi(t){return t[0]!=="$"&&!xr(t)}const zn=t=>t==="_"||t==="_ctx"||t==="$stable",Qn=t=>F(t)?t.map(st):[st(t)],hc=(t,e,r)=>{if(e._n)return e;const s=Al((...n)=>Qn(e(...n)),r);return s._c=!1,s},na=(t,e,r)=>{const s=t._ctx;for(const n in t){if(zn(n))continue;const i=t[n];if(W(i))e[n]=hc(n,i,s);else if(i!=null){const o=Qn(i);e[n]=()=>o}}},ia=(t,e)=>{const r=Qn(e);t.slots.default=()=>r},oa=(t,e,r)=>{for(const s in e)(r||!zn(s))&&(t[s]=e[s])},dc=(t,e,r)=>{const s=t.slots=ea();if(t.vnode.shapeFlag&32){const n=e._;n?(oa(s,e,r),r&&wo(s,"_",n,!0)):na(e,s)}else e&&ia(t,e)},fc=(t,e,r)=>{const{vnode:s,slots:n}=t;let i=!0,o=se;if(s.shapeFlag&32){const a=e._;a?r&&a===1?i=!1:oa(n,e,r):(i=!e.$stable,na(e,n)),o=e}else e&&(ia(t,e),o={default:1});if(i)for(const a in n)!zn(a)&&o[a]==null&&delete n[a]},De=wc;function pc(t){return gc(t)}function gc(t,e){const r=Cs();r.__VUE__=!0;const{insert:s,remove:n,patchProp:i,createElement:o,createText:a,createComment:l,setText:c,setElementText:u,parentNode:h,nextSibling:p,setScopeId:d=nt,insertStaticContent:v}=t,b=(f,g,_,R=null,S=null,E=null,$=void 0,I=null,C=!!g.dynamicChildren)=>{if(f===g)return;f&&!Rr(f,g)&&(R=Qt(f),z(f,S,E,!0),f=null),g.patchFlag===-2&&(C=!1,g.dynamicChildren=null);const{type:T,ref:L,shapeFlag:U}=g;switch(T){case Ns:O(f,g,_,R);break;case It:y(f,g,_,R);break;case zs:f==null&&k(g,_,R,$);break;case xe:Gt(f,g,_,R,S,E,$,I,C);break;default:U&1?x(f,g,_,R,S,E,$,I,C):U&6?zt(f,g,_,R,S,E,$,I,C):(U&64||U&128)&&T.process(f,g,_,R,S,E,$,I,C,Er)}L!=null&&S?Pr(L,f&&f.ref,E,g||f,!g):L==null&&f&&f.ref!=null&&Pr(f.ref,null,E,f,!0)},O=(f,g,_,R)=>{if(f==null)s(g.el=a(g.children),_,R);else{const S=g.el=f.el;g.children!==f.children&&c(S,g.children)}},y=(f,g,_,R)=>{f==null?s(g.el=l(g.children||""),_,R):g.el=f.el},k=(f,g,_,R)=>{[f.el,f.anchor]=v(f.children,g,_,R,f.el,f.anchor)},w=({el:f,anchor:g},_,R)=>{let S;for(;f&&f!==g;)S=p(f),s(f,_,R),f=S;s(g,_,R)},A=({el:f,anchor:g})=>{let _;for(;f&&f!==g;)_=p(f),n(f),f=_;n(g)},x=(f,g,_,R,S,E,$,I,C)=>{if(g.type==="svg"?$="svg":g.type==="math"&&($="mathml"),f==null)J(g,_,R,S,E,$,I,C);else{const T=f.el&&f.el._isVueCE?f.el:null;try{T&&T._beginPatch(),be(f,g,S,E,$,I,C)}finally{T&&T._endPatch()}}},J=(f,g,_,R,S,E,$,I)=>{let C,T;const{props:L,shapeFlag:U,transition:D,dirs:V}=f;if(C=f.el=o(f.type,E,L&&L.is,L),U&8?u(C,f.children):U&16&&ve(f.children,C,null,R,S,Gs(f,E),$,I),V&&jt(f,null,R,"created"),Q(C,f,f.scopeId,$,R),L){for(const ne in L)ne!=="value"&&!xr(ne)&&i(C,ne,null,L[ne],E,R);"value"in L&&i(C,"value",null,L.value,E),(T=L.onVnodeBeforeMount)&&tt(T,R,f)}V&&jt(f,null,R,"beforeMount");const G=vc(S,D);G&&D.beforeEnter(C),s(C,g,_),((T=L&&L.onVnodeMounted)||G||V)&&De(()=>{T&&tt(T,R,f),G&&D.enter(C),V&&jt(f,null,R,"mounted")},S)},Q=(f,g,_,R,S)=>{if(_&&d(f,_),R)for(let E=0;E<R.length;E++)d(f,R[E]);if(S){let E=S.subTree;if(g===E||ua(E.type)&&(E.ssContent===g||E.ssFallback===g)){const $=S.vnode;Q(f,$,$.scopeId,$.slotScopeIds,S.parent)}}},ve=(f,g,_,R,S,E,$,I,C=0)=>{for(let T=C;T<f.length;T++){const L=f[T]=I?Tt(f[T]):st(f[T]);b(null,L,g,_,R,S,E,$,I)}},be=(f,g,_,R,S,E,$)=>{const I=g.el=f.el;let{patchFlag:C,dynamicChildren:T,dirs:L}=g;C|=f.patchFlag&16;const U=f.props||se,D=g.props||se;let V;if(_&&Ut(_,!1),(V=D.onVnodeBeforeUpdate)&&tt(V,_,g,f),L&&jt(g,f,_,"beforeUpdate"),_&&Ut(_,!0),(U.innerHTML&&D.innerHTML==null||U.textContent&&D.textContent==null)&&u(I,""),T?ct(f.dynamicChildren,T,I,_,R,Gs(g,S),E):$||Z(f,g,I,null,_,R,Gs(g,S),E,!1),C>0){if(C&16)Pt(I,U,D,_,S);else if(C&2&&U.class!==D.class&&i(I,"class",null,D.class,S),C&4&&i(I,"style",U.style,D.style,S),C&8){const G=g.dynamicProps;for(let ne=0;ne<G.length;ne++){const ee=G[ne],Ie=U[ee],Pe=D[ee];(Pe!==Ie||ee==="value")&&i(I,ee,Ie,Pe,S,_)}}C&1&&f.children!==g.children&&u(I,g.children)}else!$&&T==null&&Pt(I,U,D,_,S);((V=D.onVnodeUpdated)||L)&&De(()=>{V&&tt(V,_,g,f),L&&jt(g,f,_,"updated")},R)},ct=(f,g,_,R,S,E,$)=>{for(let I=0;I<g.length;I++){const C=f[I],T=g[I],L=C.el&&(C.type===xe||!Rr(C,T)||C.shapeFlag&198)?h(C.el):_;b(C,T,L,null,R,S,E,$,!0)}},Pt=(f,g,_,R,S)=>{if(g!==_){if(g!==se)for(const E in g)!xr(E)&&!(E in _)&&i(f,E,g[E],null,S,R);for(const E in _){if(xr(E))continue;const $=_[E],I=g[E];$!==I&&E!=="value"&&i(f,E,I,$,S,R)}"value"in _&&i(f,"value",g.value,_.value,S)}},Gt=(f,g,_,R,S,E,$,I,C)=>{const T=g.el=f?f.el:a(""),L=g.anchor=f?f.anchor:a("");let{patchFlag:U,dynamicChildren:D,slotScopeIds:V}=g;V&&(I=I?I.concat(V):V),f==null?(s(T,_,R),s(L,_,R),ve(g.children||[],_,L,S,E,$,I,C)):U>0&&U&64&&D&&f.dynamicChildren&&f.dynamicChildren.length===D.length?(ct(f.dynamicChildren,D,_,S,E,$,I),(g.key!=null||S&&g===S.subTree)&&aa(f,g,!0)):Z(f,g,_,L,S,E,$,I,C)},zt=(f,g,_,R,S,E,$,I,C)=>{g.slotScopeIds=I,f==null?g.shapeFlag&512?S.ctx.activate(g,_,R,$,C):Sr(g,_,R,S,E,$,C):ts(f,g,C)},Sr=(f,g,_,R,S,E,$)=>{const I=f.component=Tc(f,R,S);if(Ho(f)&&(I.ctx.renderer=Er),Ac(I,!1,$),I.asyncDep){if(S&&S.registerDep(I,de,$),!f.el){const C=I.subTree=it(It);y(null,C,g,_),f.placeholder=C.el}}else de(I,f,g,_,S,E,$)},ts=(f,g,_)=>{const R=g.component=f.component;if(oc(f,g,_))if(R.asyncDep&&!R.asyncResolved){le(R,g,_);return}else R.next=g,R.update();else g.el=f.el,R.vnode=g},de=(f,g,_,R,S,E,$)=>{const I=()=>{if(f.isMounted){let{next:U,bu:D,u:V,parent:G,vnode:ne}=f;{const Ze=la(f);if(Ze){U&&(U.el=ne.el,le(f,U,$)),Ze.asyncDep.then(()=>{f.isUnmounted||I()});return}}let ee=U,Ie;Ut(f,!1),U?(U.el=ne.el,le(f,U,$)):U=ne,D&&hs(D),(Ie=U.props&&U.props.onVnodeBeforeUpdate)&&tt(Ie,G,U,ne),Ut(f,!0);const Pe=wi(f),Xe=f.subTree;f.subTree=Pe,b(Xe,Pe,h(Xe.el),Qt(Xe),f,S,E),U.el=Pe.el,ee===null&&ac(f,Pe.el),V&&De(V,S),(Ie=U.props&&U.props.onVnodeUpdated)&&De(()=>tt(Ie,G,U,ne),S)}else{let U;const{el:D,props:V}=g,{bm:G,m:ne,parent:ee,root:Ie,type:Pe}=f,Xe=$r(g);Ut(f,!1),G&&hs(G),!Xe&&(U=V&&V.onVnodeBeforeMount)&&tt(U,ee,g),Ut(f,!0);{Ie.ce&&Ie.ce._def.shadowRoot!==!1&&Ie.ce._injectChildStyle(Pe);const Ze=f.subTree=wi(f);b(null,Ze,_,R,f,S,E),g.el=Ze.el}if(ne&&De(ne,S),!Xe&&(U=V&&V.onVnodeMounted)){const Ze=g;De(()=>tt(U,ee,Ze),S)}(g.shapeFlag&256||ee&&$r(ee.vnode)&&ee.vnode.shapeFlag&256)&&f.a&&De(f.a,S),f.isMounted=!0,g=_=R=null}};f.scope.on();const C=f.effect=new So(I);f.scope.off();const T=f.update=C.run.bind(C),L=f.job=C.runIfDirty.bind(C);L.i=f,L.id=f.uid,C.scheduler=()=>Hn(L),Ut(f,!0),T()},le=(f,g,_)=>{g.component=f;const R=f.vnode.props;f.vnode=g,f.next=null,cc(f,g.props,R,_),fc(f,g.children,_),vt(),di(f),mt()},Z=(f,g,_,R,S,E,$,I,C=!1)=>{const T=f&&f.children,L=f?f.shapeFlag:0,U=g.children,{patchFlag:D,shapeFlag:V}=g;if(D>0){if(D&128){j(T,U,_,R,S,E,$,I,C);return}else if(D&256){P(T,U,_,R,S,E,$,I,C);return}}V&8?(L&16&&$t(T,S,E),U!==T&&u(_,U)):L&16?V&16?j(T,U,_,R,S,E,$,I,C):$t(T,S,E,!0):(L&8&&u(_,""),V&16&&ve(U,_,R,S,E,$,I,C))},P=(f,g,_,R,S,E,$,I,C)=>{f=f||hr,g=g||hr;const T=f.length,L=g.length,U=Math.min(T,L);let D;for(D=0;D<U;D++){const V=g[D]=C?Tt(g[D]):st(g[D]);b(f[D],V,_,null,S,E,$,I,C)}T>L?$t(f,S,E,!0,!1,U):ve(g,_,R,S,E,$,I,C,U)},j=(f,g,_,R,S,E,$,I,C)=>{let T=0;const L=g.length;let U=f.length-1,D=L-1;for(;T<=U&&T<=D;){const V=f[T],G=g[T]=C?Tt(g[T]):st(g[T]);if(Rr(V,G))b(V,G,_,null,S,E,$,I,C);else break;T++}for(;T<=U&&T<=D;){const V=f[U],G=g[D]=C?Tt(g[D]):st(g[D]);if(Rr(V,G))b(V,G,_,null,S,E,$,I,C);else break;U--,D--}if(T>U){if(T<=D){const V=D+1,G=V<L?g[V].el:R;for(;T<=D;)b(null,g[T]=C?Tt(g[T]):st(g[T]),_,G,S,E,$,I,C),T++}}else if(T>D)for(;T<=U;)z(f[T],S,E,!0),T++;else{const V=T,G=T,ne=new Map;for(T=G;T<=D;T++){const je=g[T]=C?Tt(g[T]):st(g[T]);je.key!=null&&ne.set(je.key,T)}let ee,Ie=0;const Pe=D-G+1;let Xe=!1,Ze=0;const kr=new Array(Pe);for(T=0;T<Pe;T++)kr[T]=0;for(T=V;T<=U;T++){const je=f[T];if(Ie>=Pe){z(je,S,E,!0);continue}let et;if(je.key!=null)et=ne.get(je.key);else for(ee=G;ee<=D;ee++)if(kr[ee-G]===0&&Rr(je,g[ee])){et=ee;break}et===void 0?z(je,S,E,!0):(kr[et-G]=T+1,et>=Ze?Ze=et:Xe=!0,b(je,g[et],_,null,S,E,$,I,C),Ie++)}const ii=Xe?mc(kr):hr;for(ee=ii.length-1,T=Pe-1;T>=0;T--){const je=G+T,et=g[je],oi=g[je+1],ai=je+1<L?oi.el||ca(oi):R;kr[T]===0?b(null,et,_,ai,S,E,$,I,C):Xe&&(ee<0||T!==ii[ee]?q(et,_,ai,2):ee--)}}},q=(f,g,_,R,S=null)=>{const{el:E,type:$,transition:I,children:C,shapeFlag:T}=f;if(T&6){q(f.component.subTree,g,_,R);return}if(T&128){f.suspense.move(g,_,R);return}if(T&64){$.move(f,g,_,Er);return}if($===xe){s(E,g,_);for(let U=0;U<C.length;U++)q(C[U],g,_,R);s(f.anchor,g,_);return}if($===zs){w(f,g,_);return}if(R!==2&&T&1&&I)if(R===0)I.beforeEnter(E),s(E,g,_),De(()=>I.enter(E),S);else{const{leave:U,delayLeave:D,afterLeave:V}=I,G=()=>{f.ctx.isUnmounted?n(E):s(E,g,_)},ne=()=>{E._isLeaving&&E[jl](!0),U(E,()=>{G(),V&&V()})};D?D(E,G,ne):ne()}else s(E,g,_)},z=(f,g,_,R=!1,S=!1)=>{const{type:E,props:$,ref:I,children:C,dynamicChildren:T,shapeFlag:L,patchFlag:U,dirs:D,cacheIndex:V}=f;if(U===-2&&(S=!1),I!=null&&(vt(),Pr(I,null,_,f,!0),mt()),V!=null&&(g.renderCache[V]=void 0),L&256){g.ctx.deactivate(f);return}const G=L&1&&D,ne=!$r(f);let ee;if(ne&&(ee=$&&$.onVnodeBeforeUnmount)&&tt(ee,g,f),L&6)Ye(f.component,_,R);else{if(L&128){f.suspense.unmount(_,R);return}G&&jt(f,null,g,"beforeUnmount"),L&64?f.type.remove(f,g,_,Er,R):T&&!T.hasOnce&&(E!==xe||U>0&&U&64)?$t(T,g,_,!1,!0):(E===xe&&U&384||!S&&L&16)&&$t(C,g,_),R&&Qe(f)}(ne&&(ee=$&&$.onVnodeUnmounted)||G)&&De(()=>{ee&&tt(ee,g,f),G&&jt(f,null,g,"unmounted")},_)},Qe=f=>{const{type:g,el:_,anchor:R,transition:S}=f;if(g===xe){bt(_,R);return}if(g===zs){A(f);return}const E=()=>{n(_),S&&!S.persisted&&S.afterLeave&&S.afterLeave()};if(f.shapeFlag&1&&S&&!S.persisted){const{leave:$,delayLeave:I}=S,C=()=>$(_,E);I?I(f.el,E,C):C()}else E()},bt=(f,g)=>{let _;for(;f!==g;)_=p(f),n(f),f=_;n(g)},Ye=(f,g,_)=>{const{bum:R,scope:S,job:E,subTree:$,um:I,m:C,a:T}=f;bi(C),bi(T),R&&hs(R),S.stop(),E&&(E.flags|=8,z($,f,g,_)),I&&De(I,g),De(()=>{f.isUnmounted=!0},g)},$t=(f,g,_,R=!1,S=!1,E=0)=>{for(let $=E;$<f.length;$++)z(f[$],g,_,R,S)},Qt=f=>{if(f.shapeFlag&6)return Qt(f.component.subTree);if(f.shapeFlag&128)return f.suspense.next();const g=p(f.anchor||f.el),_=g&&g[Pl];return _?p(_):g};let St=!1;const ni=(f,g,_)=>{let R;f==null?g._vnode&&(z(g._vnode,null,null,!0),R=g._vnode.component):b(g._vnode||null,f,g,null,null,null,_),g._vnode=f,St||(St=!0,di(R),Mo(),St=!1)},Er={p:b,um:z,m:q,r:Qe,mt:Sr,mc:ve,pc:Z,pbc:ct,n:Qt,o:t};return{render:ni,hydrate:void 0,createApp:ec(ni)}}function Gs({type:t,props:e},r){return r==="svg"&&t==="foreignObject"||r==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:r}function Ut({effect:t,job:e},r){r?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function vc(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function aa(t,e,r=!1){const s=t.children,n=e.children;if(F(s)&&F(n))for(let i=0;i<s.length;i++){const o=s[i];let a=n[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=n[i]=Tt(n[i]),a.el=o.el),!r&&a.patchFlag!==-2&&aa(o,a)),a.type===Ns&&(a.patchFlag!==-1?a.el=o.el:a.__elIndex=i+(t.type===xe?1:0)),a.type===It&&!a.el&&(a.el=o.el)}}function mc(t){const e=t.slice(),r=[0];let s,n,i,o,a;const l=t.length;for(s=0;s<l;s++){const c=t[s];if(c!==0){if(n=r[r.length-1],t[n]<c){e[s]=n,r.push(s);continue}for(i=0,o=r.length-1;i<o;)a=i+o>>1,t[r[a]]<c?i=a+1:o=a;c<t[r[i]]&&(i>0&&(e[s]=r[i-1]),r[i]=s)}}for(i=r.length,o=r[i-1];i-- >0;)r[i]=o,o=e[o];return r}function la(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:la(e)}function bi(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}function ca(t){if(t.placeholder)return t.placeholder;const e=t.component;return e?ca(e.subTree):null}const ua=t=>t.__isSuspense;function wc(t,e){e&&e.pendingBranch?F(t)?e.effects.push(...t):e.effects.push(t):Rl(t)}const xe=Symbol.for("v-fgt"),Ns=Symbol.for("v-txt"),It=Symbol.for("v-cmt"),zs=Symbol.for("v-stc"),Ur=[];let qe=null;function K(t=!1){Ur.push(qe=t?null:[])}function _c(){Ur.pop(),qe=Ur[Ur.length-1]||null}let qr=1;function Si(t,e=!1){qr+=t,t<0&&qe&&e&&(qe.hasOnce=!0)}function ha(t){return t.dynamicChildren=qr>0?qe||hr:null,_c(),qr>0&&qe&&qe.push(t),t}function H(t,e,r,s,n,i){return ha(m(t,e,r,s,n,i,!0))}function or(t,e,r,s,n){return ha(it(t,e,r,s,n,!0))}function da(t){return t?t.__v_isVNode===!0:!1}function Rr(t,e){return t.type===e.type&&t.key===e.key}const fa=({key:t})=>t??null,ps=({ref:t,ref_key:e,ref_for:r})=>(typeof t=="number"&&(t=""+t),t!=null?ge(t)||ke(t)||W(t)?{i:Fe,r:t,k:e,f:!!r}:t:null);function m(t,e=null,r=null,s=0,n=null,i=t===xe?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&fa(e),ref:e&&ps(e),scopeId:Fo,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:s,dynamicProps:n,dynamicChildren:null,appContext:null,ctx:Fe};return a?(Xn(l,r),i&128&&t.normalize(l)):r&&(l.shapeFlag|=ge(r)?8:16),qr>0&&!o&&qe&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&qe.push(l),l}const it=yc;function yc(t,e=null,r=null,s=0,n=null,i=!1){if((!t||t===Hl)&&(t=It),da(t)){const a=wr(t,e,!0);return r&&Xn(a,r),qr>0&&!i&&qe&&(a.shapeFlag&6?qe[qe.indexOf(t)]=a:qe.push(a)),a.patchFlag=-2,a}if(Ic(t)&&(t=t.__vccOpts),e){e=bc(e);let{class:a,style:l}=e;a&&!ge(a)&&(e.class=Je(a)),ae(l)&&(Wn(l)&&!F(l)&&(l=Te({},l)),e.style=Is(l))}const o=ge(t)?1:ua(t)?128:$l(t)?64:ae(t)?4:W(t)?2:0;return m(t,e,r,s,n,o,i,!0)}function bc(t){return t?Wn(t)||ta(t)?Te({},t):t:null}function wr(t,e,r=!1,s=!1){const{props:n,ref:i,patchFlag:o,children:a,transition:l}=t,c=e?Sc(n||{},e):n,u={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&fa(c),ref:e&&e.ref?r&&i?F(i)?i.concat(ps(e)):[i,ps(e)]:ps(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==xe?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&wr(t.ssContent),ssFallback:t.ssFallback&&wr(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&s&&Jn(u,l.clone(u)),u}function Yn(t=" ",e=0){return it(Ns,null,t,e)}function we(t="",e=!1){return e?(K(),or(It,null,t)):it(It,null,t)}function st(t){return t==null||typeof t=="boolean"?it(It):F(t)?it(xe,null,t.slice()):da(t)?Tt(t):it(Ns,null,String(t))}function Tt(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:wr(t)}function Xn(t,e){let r=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(F(e))r=16;else if(typeof e=="object")if(s&65){const n=e.default;n&&(n._c&&(n._d=!1),Xn(t,n()),n._c&&(n._d=!0));return}else{r=32;const n=e._;!n&&!ta(e)?e._ctx=Fe:n===3&&Fe&&(Fe.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else W(e)?(e={default:e,_ctx:Fe},r=32):(e=String(e),s&64?(r=16,e=[Yn(e)]):r=8);t.children=e,t.shapeFlag|=r}function Sc(...t){const e={};for(let r=0;r<t.length;r++){const s=t[r];for(const n in s)if(n==="class")e.class!==s.class&&(e.class=Je([e.class,s.class]));else if(n==="style")e.style=Is([e.style,s.style]);else if(As(n)){const i=e[n],o=s[n];o&&i!==o&&!(F(i)&&i.includes(o))&&(e[n]=i?[].concat(i,o):o)}else n!==""&&(e[n]=s[n])}return e}function tt(t,e,r,s=null){lt(t,e,7,[r,s])}const Ec=Yo();let kc=0;function Tc(t,e,r){const s=t.type,n=(e?e.appContext:t.appContext)||Ec,i={uid:kc++,vnode:t,type:s,parent:e,appContext:n,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Ga(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(n.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:sa(s,n),emitsOptions:Xo(s,n),emit:null,emitted:null,propsDefaults:se,inheritAttrs:s.inheritAttrs,ctx:se,data:se,props:se,attrs:se,slots:se,refs:se,setupState:se,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=rc.bind(null,i),t.ce&&t.ce(i),i}let Ce=null;const Rc=()=>Ce||Fe;let Es,yn;{const t=Cs(),e=(r,s)=>{let n;return(n=t[r])||(n=t[r]=[]),n.push(s),i=>{n.length>1?n.forEach(o=>o(i)):n[0](i)}};Es=e("__VUE_INSTANCE_SETTERS__",r=>Ce=r),yn=e("__VUE_SSR_SETTERS__",r=>Fr=r)}const Zr=t=>{const e=Ce;return Es(t),t.scope.on(),()=>{t.scope.off(),Es(e)}},Ei=()=>{Ce&&Ce.scope.off(),Es(null)};function pa(t){return t.vnode.shapeFlag&4}let Fr=!1;function Ac(t,e=!1,r=!1){e&&yn(e);const{props:s,children:n}=t.vnode,i=pa(t);lc(t,s,i,e),dc(t,n,r||e);const o=i?Oc(t,e):void 0;return e&&yn(!1),o}function Oc(t,e){const r=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,Jl);const{setup:s}=r;if(s){vt();const n=t.setupContext=s.length>1?Cc(t):null,i=Zr(t),o=Xr(s,t,0,[t.props,n]),a=po(o);if(mt(),i(),(a||t.sp)&&!$r(t)&&Wo(t),a){if(o.then(Ei,Ei),e)return o.then(l=>{ki(t,l)}).catch(l=>{$s(l,t,0)});t.asyncDep=o}else ki(t,o)}else ga(t)}function ki(t,e,r){W(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:ae(e)&&(t.setupState=No(e)),ga(t)}function ga(t,e,r){const s=t.type;t.render||(t.render=s.render||nt);{const n=Zr(t);vt();try{Gl(t)}finally{mt(),n()}}}const xc={get(t,e){return Ee(t,"get",""),t[e]}};function Cc(t){const e=r=>{t.exposed=r||{}};return{attrs:new Proxy(t.attrs,xc),slots:t.slots,emit:t.emit,expose:e}}function Ds(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(No(gl(t.exposed)),{get(e,r){if(r in e)return e[r];if(r in jr)return jr[r](t)},has(e,r){return r in e||r in jr}})):t.proxy}function Ic(t){return W(t)&&"__vccOpts"in t}const gr=(t,e)=>bl(t,e,Fr),Pc="3.5.26";/**
* @vue/runtime-dom v3.5.26
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let bn;const Ti=typeof window<"u"&&window.trustedTypes;if(Ti)try{bn=Ti.createPolicy("vue",{createHTML:t=>t})}catch{}const va=bn?t=>bn.createHTML(t):t=>t,$c="http://www.w3.org/2000/svg",jc="http://www.w3.org/1998/Math/MathML",ht=typeof document<"u"?document:null,Ri=ht&&ht.createElement("template"),Uc={insert:(t,e,r)=>{e.insertBefore(t,r||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,r,s)=>{const n=e==="svg"?ht.createElementNS($c,t):e==="mathml"?ht.createElementNS(jc,t):r?ht.createElement(t,{is:r}):ht.createElement(t);return t==="select"&&s&&s.multiple!=null&&n.setAttribute("multiple",s.multiple),n},createText:t=>ht.createTextNode(t),createComment:t=>ht.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>ht.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,r,s,n,i){const o=r?r.previousSibling:e.lastChild;if(n&&(n===i||n.nextSibling))for(;e.insertBefore(n.cloneNode(!0),r),!(n===i||!(n=n.nextSibling)););else{Ri.innerHTML=va(s==="svg"?`<svg>${t}</svg>`:s==="mathml"?`<math>${t}</math>`:t);const a=Ri.content;if(s==="svg"||s==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,r)}return[o?o.nextSibling:e.firstChild,r?r.previousSibling:e.lastChild]}},Nc=Symbol("_vtc");function Dc(t,e,r){const s=t[Nc];s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):r?t.setAttribute("class",e):t.className=e}const Ai=Symbol("_vod"),Lc=Symbol("_vsh"),Bc=Symbol(""),Mc=/(?:^|;)\s*display\s*:/;function qc(t,e,r){const s=t.style,n=ge(r);let i=!1;if(r&&!n){if(e)if(ge(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();r[a]==null&&gs(s,a,"")}else for(const o in e)r[o]==null&&gs(s,o,"");for(const o in r)o==="display"&&(i=!0),gs(s,o,r[o])}else if(n){if(e!==r){const o=s[Bc];o&&(r+=";"+o),s.cssText=r,i=Mc.test(r)}}else e&&t.removeAttribute("style");Ai in t&&(t[Ai]=i?s.display:"",t[Lc]&&(s.display="none"))}const Oi=/\s*!important$/;function gs(t,e,r){if(F(r))r.forEach(s=>gs(t,e,s));else if(r==null&&(r=""),e.startsWith("--"))t.setProperty(e,r);else{const s=Fc(t,e);Oi.test(r)?t.setProperty(Ht(s),r.replace(Oi,""),"important"):t[s]=r}}const xi=["Webkit","Moz","ms"],Qs={};function Fc(t,e){const r=Qs[e];if(r)return r;let s=Ct(e);if(s!=="filter"&&s in t)return Qs[e]=s;s=mo(s);for(let n=0;n<xi.length;n++){const i=xi[n]+s;if(i in t)return Qs[e]=i}return e}const Ci="http://www.w3.org/1999/xlink";function Ii(t,e,r,s,n,i=Ha(e)){s&&e.startsWith("xlink:")?r==null?t.removeAttributeNS(Ci,e.slice(6,e.length)):t.setAttributeNS(Ci,e,r):r==null||i&&!_o(r)?t.removeAttribute(e):t.setAttribute(e,i?"":at(r)?String(r):r)}function Pi(t,e,r,s,n){if(e==="innerHTML"||e==="textContent"){r!=null&&(t[e]=e==="innerHTML"?va(r):r);return}const i=t.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?t.getAttribute("value")||"":t.value,l=r==null?t.type==="checkbox"?"on":"":String(r);(a!==l||!("_value"in t))&&(t.value=l),r==null&&t.removeAttribute(e),t._value=r;return}let o=!1;if(r===""||r==null){const a=typeof t[e];a==="boolean"?r=_o(r):r==null&&a==="string"?(r="",o=!0):a==="number"&&(r=0,o=!0)}try{t[e]=r}catch{}o&&t.removeAttribute(n||e)}function At(t,e,r,s){t.addEventListener(e,r,s)}function Kc(t,e,r,s){t.removeEventListener(e,r,s)}const $i=Symbol("_vei");function Vc(t,e,r,s,n=null){const i=t[$i]||(t[$i]={}),o=i[e];if(s&&o)o.value=s;else{const[a,l]=Wc(e);if(s){const c=i[e]=Gc(s,n);At(t,a,c,l)}else o&&(Kc(t,a,o,l),i[e]=void 0)}}const ji=/(?:Once|Passive|Capture)$/;function Wc(t){let e;if(ji.test(t)){e={};let s;for(;s=t.match(ji);)t=t.slice(0,t.length-s[0].length),e[s[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Ht(t.slice(2)),e]}let Ys=0;const Hc=Promise.resolve(),Jc=()=>Ys||(Hc.then(()=>Ys=0),Ys=Date.now());function Gc(t,e){const r=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=r.attached)return;lt(zc(s,r.value),e,5,[s])};return r.value=t,r.attached=Jc(),r}function zc(t,e){if(F(e)){const r=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{r.call(t),t._stopped=!0},e.map(s=>n=>!n._stopped&&s&&s(n))}else return e}const Ui=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,Qc=(t,e,r,s,n,i)=>{const o=n==="svg";e==="class"?Dc(t,s,o):e==="style"?qc(t,r,s):As(e)?jn(e)||Vc(t,e,r,s,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Yc(t,e,s,o))?(Pi(t,e,s),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Ii(t,e,s,o,i,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!ge(s))?Pi(t,Ct(e),s,i,e):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),Ii(t,e,s,o))};function Yc(t,e,r,s){if(s)return!!(e==="innerHTML"||e==="textContent"||e in t&&Ui(e)&&W(r));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="sandbox"&&t.tagName==="IFRAME"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const n=t.tagName;if(n==="IMG"||n==="VIDEO"||n==="CANVAS"||n==="SOURCE")return!1}return Ui(e)&&ge(r)?!1:e in t}const _r=t=>{const e=t.props["onUpdate:modelValue"]||!1;return F(e)?r=>hs(e,r):e};function Xc(t){t.target.composing=!0}function Ni(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const gt=Symbol("_assign");function Di(t,e,r){return e&&(t=t.trim()),r&&(t=xs(t)),t}const ot={created(t,{modifiers:{lazy:e,trim:r,number:s}},n){t[gt]=_r(n);const i=s||n.props&&n.props.type==="number";At(t,e?"change":"input",o=>{o.target.composing||t[gt](Di(t.value,r,i))}),(r||i)&&At(t,"change",()=>{t.value=Di(t.value,r,i)}),e||(At(t,"compositionstart",Xc),At(t,"compositionend",Ni),At(t,"change",Ni))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:r,modifiers:{lazy:s,trim:n,number:i}},o){if(t[gt]=_r(o),t.composing)return;const a=(i||t.type==="number")&&!/^0\d/.test(t.value)?xs(t.value):t.value,l=e??"";a!==l&&(document.activeElement===t&&t.type!=="range"&&(s&&e===r||n&&t.value.trim()===l)||(t.value=l))}},ma={deep:!0,created(t,e,r){t[gt]=_r(r),At(t,"change",()=>{const s=t._modelValue,n=Kr(t),i=t.checked,o=t[gt];if(F(s)){const a=Dn(s,n),l=a!==-1;if(i&&!l)o(s.concat(n));else if(!i&&l){const c=[...s];c.splice(a,1),o(c)}}else if(yr(s)){const a=new Set(s);i?a.add(n):a.delete(n),o(a)}else o(wa(t,i))})},mounted:Li,beforeUpdate(t,e,r){t[gt]=_r(r),Li(t,e,r)}};function Li(t,{value:e,oldValue:r},s){t._modelValue=e;let n;if(F(e))n=Dn(e,s.props.value)>-1;else if(yr(e))n=e.has(s.props.value);else{if(e===r)return;n=Yr(e,wa(t,!0))}t.checked!==n&&(t.checked=n)}const Zc={deep:!0,created(t,{value:e,modifiers:{number:r}},s){const n=yr(e);At(t,"change",()=>{const i=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>r?xs(Kr(o)):Kr(o));t[gt](t.multiple?n?new Set(i):i:i[0]),t._assigning=!0,Lo(()=>{t._assigning=!1})}),t[gt]=_r(s)},mounted(t,{value:e}){Bi(t,e)},beforeUpdate(t,e,r){t[gt]=_r(r)},updated(t,{value:e}){t._assigning||Bi(t,e)}};function Bi(t,e){const r=t.multiple,s=F(e);if(!(r&&!s&&!yr(e))){for(let n=0,i=t.options.length;n<i;n++){const o=t.options[n],a=Kr(o);if(r)if(s){const l=typeof a;l==="string"||l==="number"?o.selected=e.some(c=>String(c)===String(a)):o.selected=Dn(e,a)>-1}else o.selected=e.has(a);else if(Yr(Kr(o),e)){t.selectedIndex!==n&&(t.selectedIndex=n);return}}!r&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function Kr(t){return"_value"in t?t._value:t.value}function wa(t,e){const r=e?"_trueValue":"_falseValue";return r in t?t[r]:e}const eu=["ctrl","shift","alt","meta"],tu={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>eu.some(r=>t[`${r}Key`]&&!e.includes(r))},Ls=(t,e)=>{const r=t._withMods||(t._withMods={}),s=e.join(".");return r[s]||(r[s]=(n,...i)=>{for(let o=0;o<e.length;o++){const a=tu[e[o]];if(a&&a(n,e))return}return t(n,...i)})},ru=Te({patchProp:Qc},Uc);let Mi;function su(){return Mi||(Mi=pc(ru))}const nu=(...t)=>{const e=su().createApp(...t),{mount:r}=e;return e.mount=s=>{const n=ou(s);if(!n)return;const i=e._component;!W(i)&&!i.render&&!i.template&&(i.template=n.innerHTML),n.nodeType===1&&(n.textContent="");const o=r(n,!1,iu(n));return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),o},e};function iu(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function ou(t){return ge(t)?document.querySelector(t):t}function Bs(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r}function au(t,e,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):n(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})}const lu=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Zn extends Error{constructor(e,r="FunctionsError",s){super(e),this.name=r,this.context=s}}class cu extends Zn{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class qi extends Zn{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Fi extends Zn{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Sn;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Sn||(Sn={}));class uu{constructor(e,{headers:r={},customFetch:s,region:n=Sn.Any}={}){this.url=e,this.headers=r,this.region=n,this.fetch=lu(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return au(this,arguments,void 0,function*(r,s={}){var n;let i,o;try{const{headers:a,method:l,body:c,signal:u,timeout:h}=s;let p={},{region:d}=s;d||(d=this.region);const v=new URL(`${this.url}/${r}`);d&&d!=="any"&&(p["x-region"]=d,v.searchParams.set("forceFunctionRegion",d));let b;c&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(p["Content-Type"]="application/octet-stream",b=c):typeof c=="string"?(p["Content-Type"]="text/plain",b=c):typeof FormData<"u"&&c instanceof FormData?b=c:(p["Content-Type"]="application/json",b=JSON.stringify(c)):b=c;let O=u;h&&(o=new AbortController,i=setTimeout(()=>o.abort(),h),u?(O=o.signal,u.addEventListener("abort",()=>o.abort())):O=o.signal);const y=yield this.fetch(v.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},p),this.headers),a),body:b,signal:O}).catch(x=>{throw new cu(x)}),k=y.headers.get("x-relay-error");if(k&&k==="true")throw new qi(y);if(!y.ok)throw new Fi(y);let w=((n=y.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),A;return w==="application/json"?A=yield y.json():w==="application/octet-stream"||w==="application/pdf"?A=yield y.blob():w==="text/event-stream"?A=y:w==="multipart/form-data"?A=yield y.formData():A=yield y.text(),{data:A,error:null,response:y}}catch(a){return{data:null,error:a,response:a instanceof Fi||a instanceof qi?a.context:void 0}}finally{i&&clearTimeout(i)}})}}var hu=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},du=class{constructor(t){var e,r;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(r=t.isMaybeSingle)!==null&&r!==void 0?r:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let n=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let o=null,a=null,l=null,c=i.status,u=i.statusText;if(i.ok){var h,p;if(r.method!=="HEAD"){var d;const y=await i.text();y===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((d=r.headers.get("Accept"))===null||d===void 0)&&d.includes("application/vnd.pgrst.plan+text"))?a=y:a=JSON.parse(y))}const b=(h=r.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),O=(p=i.headers.get("content-range"))===null||p===void 0?void 0:p.split("/");b&&O&&O.length>1&&(l=parseInt(O[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(a)&&(a.length>1?(o={code:"PGRST116",details:`Results contain ${a.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,l=null,c=406,u="Not Acceptable"):a.length===1?a=a[0]:a=null)}else{var v;const b=await i.text();try{o=JSON.parse(b),Array.isArray(o)&&i.status===404&&(a=[],o=null,c=200,u="OK")}catch{i.status===404&&b===""?(c=204,u="No Content"):o={message:b}}if(o&&r.isMaybeSingle&&(!(o==null||(v=o.details)===null||v===void 0)&&v.includes("0 rows"))&&(o=null,c=200,u="OK"),o&&r.shouldThrowOnError)throw new hu(o)}return{error:o,data:a,count:l,status:c,statusText:u}});return this.shouldThrowOnError||(n=n.catch(i=>{var o;let a="";const l=i==null?void 0:i.cause;if(l){var c,u,h,p;const v=(c=l==null?void 0:l.message)!==null&&c!==void 0?c:"",b=(u=l==null?void 0:l.code)!==null&&u!==void 0?u:"";a=`${(h=i==null?void 0:i.name)!==null&&h!==void 0?h:"FetchError"}: ${i==null?void 0:i.message}`,a+=`

Caused by: ${(p=l==null?void 0:l.name)!==null&&p!==void 0?p:"Error"}: ${v}`,b&&(a+=` (${b})`),l!=null&&l.stack&&(a+=`
${l.stack}`)}else{var d;a=(d=i==null?void 0:i.stack)!==null&&d!==void 0?d:""}return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:a,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),n.then(t,e)}returns(){return this}overrideTypes(){return this}},fu=class extends du{select(t){let e=!1;const r=(t??"*").split("").map(s=>/\s/.test(s)&&!e?"":(s==='"'&&(e=!e),s)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:r,foreignTable:s,referencedTable:n=s}={}){const i=n?`${n}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${e?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:r=e}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,e,{foreignTable:r,referencedTable:s=r}={}){const n=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${t}`),this.url.searchParams.set(i,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:r=!1,buffers:s=!1,wal:n=!1,format:i="text"}={}){var o;const a=[t?"analyze":null,e?"verbose":null,r?"settings":null,s?"buffers":null,n?"wal":null].filter(Boolean).join("|"),l=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${l}"; options=${a};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const Ki=new RegExp("[,()]");var ar=class extends fu{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const r=Array.from(new Set(e)).map(s=>typeof s=="string"&&Ki.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}notIn(t,e){const r=Array.from(new Set(e)).map(s=>typeof s=="string"&&Ki.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`not.in.(${r})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:r,type:s}={}){let n="";s==="plain"?n="pl":s==="phrase"?n="ph":s==="websearch"&&(n="w");const i=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${n}fts${i}.${e}`),this}match(t){return Object.entries(t).forEach(([e,r])=>{this.url.searchParams.append(e,`eq.${r}`)}),this}not(t,e,r){return this.url.searchParams.append(t,`not.${e}.${r}`),this}or(t,{foreignTable:e,referencedTable:r=e}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,e,r){return this.url.searchParams.append(t,`${e}.${r}`),this}},pu=class{constructor(t,{headers:e={},schema:r,fetch:s}){this.url=t,this.headers=new Headers(e),this.schema=r,this.fetch=s}select(t,e){const{head:r=!1,count:s}=e??{},n=r?"HEAD":"GET";let i=!1;const o=(t??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),s&&this.headers.append("Prefer",`count=${s}`),new ar({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:r=!0}={}){var s;const n="POST";if(e&&this.headers.append("Prefer",`count=${e}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const i=t.reduce((o,a)=>o.concat(Object.keys(a)),[]);if(i.length>0){const o=[...new Set(i)].map(a=>`"${a}"`);this.url.searchParams.set("columns",o.join(","))}}return new ar({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:r=!1,count:s,defaultToNull:n=!0}={}){var i;const o="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),e!==void 0&&this.url.searchParams.set("on_conflict",e),s&&this.headers.append("Prefer",`count=${s}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const a=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(a.length>0){const l=[...new Set(a)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new ar({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:e}={}){var r;const s="PATCH";return e&&this.headers.append("Prefer",`count=${e}`),new ar({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:t}={}){var e;const r="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new ar({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},gu=class _a{constructor(e,{headers:r={},schema:s,fetch:n}={}){this.url=e,this.headers=new Headers(r),this.schemaName=s,this.fetch=n}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new pu(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new _a(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,r={},{head:s=!1,get:n=!1,count:i}={}){var o;let a;const l=new URL(`${this.url}/rpc/${e}`);let c;s||n?(a=s?"HEAD":"GET",Object.entries(r).filter(([h,p])=>p!==void 0).map(([h,p])=>[h,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([h,p])=>{l.searchParams.append(h,p)})):(a="POST",c=r);const u=new Headers(this.headers);return i&&u.set("Prefer",`count=${i}`),new ar({method:a,url:l,headers:u,schema:this.schemaName,body:c,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class vu{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const s=r.node,n=parseInt(s.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const s=this.getWebSocketConstructor();return new s(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const mu="2.89.0",wu=`realtime-js/${mu}`,ya="1.0.0",_u="2.0.0",Vi=ya,En=1e4,yu=1e3,bu=100;var Rt;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Rt||(Rt={}));var me;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(me||(me={}));var He;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(He||(He={}));var kn;(function(t){t.websocket="websocket"})(kn||(kn={}));var qt;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(qt||(qt={}));class Su{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,r){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(e));let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return r(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(e){var r;return this._isArrayBuffer((r=e.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var r,s;const n=(s=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(e){var r,s;const n=(s=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:{},o=new TextEncoder().encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,r,s){var n,i;const o=e.topic,a=(n=e.ref)!==null&&n!==void 0?n:"",l=(i=e.join_ref)!==null&&i!==void 0?i:"",c=e.payload.event,u=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},h=Object.keys(u).length===0?"":JSON.stringify(u);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`ref length ${a.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const p=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+a.length+o.length+c.length+h.length,d=new ArrayBuffer(this.HEADER_LENGTH+p);let v=new DataView(d),b=0;v.setUint8(b++,this.KINDS.userBroadcastPush),v.setUint8(b++,l.length),v.setUint8(b++,a.length),v.setUint8(b++,o.length),v.setUint8(b++,c.length),v.setUint8(b++,h.length),v.setUint8(b++,r),Array.from(l,y=>v.setUint8(b++,y.charCodeAt(0))),Array.from(a,y=>v.setUint8(b++,y.charCodeAt(0))),Array.from(o,y=>v.setUint8(b++,y.charCodeAt(0))),Array.from(c,y=>v.setUint8(b++,y.charCodeAt(0))),Array.from(h,y=>v.setUint8(b++,y.charCodeAt(0)));var O=new Uint8Array(d.byteLength+s.byteLength);return O.set(new Uint8Array(d),0),O.set(new Uint8Array(s),d.byteLength),O.buffer}decode(e,r){if(this._isArrayBuffer(e)){let s=this._binaryDecode(e);return r(s)}if(typeof e=="string"){const s=JSON.parse(e),[n,i,o,a,l]=s;return r({join_ref:n,ref:i,topic:o,event:a,payload:l})}return r({})}_binaryDecode(e){const r=new DataView(e),s=r.getUint8(0),n=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,r,n)}}_decodeUserBroadcast(e,r,s){const n=r.getUint8(1),i=r.getUint8(2),o=r.getUint8(3),a=r.getUint8(4);let l=this.HEADER_LENGTH+4;const c=s.decode(e.slice(l,l+n));l=l+n;const u=s.decode(e.slice(l,l+i));l=l+i;const h=s.decode(e.slice(l,l+o));l=l+o;const p=e.slice(l,e.byteLength),d=a===this.JSON_ENCODING?JSON.parse(s.decode(p)):p,v={type:this.BROADCAST_EVENT,event:u,payload:d};return o>0&&(v.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:v}}_isArrayBuffer(e){var r;return e instanceof ArrayBuffer||((r=e==null?void 0:e.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(e,r){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([s])=>r.includes(s)))}}class ba{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ie;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(ie||(ie={}));const Wi=(t,e,r={})=>{var s;const n=(s=r.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((i,o)=>(i[o]=Eu(o,t,e,n),i),{}):{}},Eu=(t,e,r,s)=>{const n=e.find(a=>a.name===t),i=n==null?void 0:n.type,o=r[t];return i&&!s.includes(i)?Sa(i,o):Tn(o)},Sa=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return Au(e,r)}switch(t){case ie.bool:return ku(e);case ie.float4:case ie.float8:case ie.int2:case ie.int4:case ie.int8:case ie.numeric:case ie.oid:return Tu(e);case ie.json:case ie.jsonb:return Ru(e);case ie.timestamp:return Ou(e);case ie.abstime:case ie.date:case ie.daterange:case ie.int4range:case ie.int8range:case ie.money:case ie.reltime:case ie.text:case ie.time:case ie.timestamptz:case ie.timetz:case ie.tsrange:case ie.tstzrange:return Tn(e);default:return Tn(e)}},Tn=t=>t,ku=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Tu=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Ru=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},Au=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,s=t[r];if(t[0]==="{"&&s==="}"){let i;const o=t.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>Sa(e,a))}return t},Ou=t=>typeof t=="string"?t.replace(" ","T"):t,Ea=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Xs{constructor(e,r,s={},n=En){this.channel=e,this.event=r,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var s;return this._hasReceived(e)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Hi;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Hi||(Hi={}));class Nr{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Nr.syncState(this.state,n,i,o),this.pendingDiffs.forEach(l=>{this.state=Nr.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(s.diff,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Nr.syncDiff(this.state,n,i,o),a())}),this.onJoin((n,i,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:o})}),this.onLeave((n,i,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,s,n){const i=this.cloneDeep(e),o=this.transformState(r),a={},l={};return this.map(i,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{const h=i[c];if(h){const p=u.map(O=>O.presence_ref),d=h.map(O=>O.presence_ref),v=u.filter(O=>d.indexOf(O.presence_ref)<0),b=h.filter(O=>p.indexOf(O.presence_ref)<0);v.length>0&&(a[c]=v),b.length>0&&(l[c]=b)}else a[c]=u}),this.syncDiff(i,{joins:a,leaves:l},s,n)}static syncDiff(e,r,s,n){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(i,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const h=e[a].map(d=>d.presence_ref),p=u.filter(d=>h.indexOf(d.presence_ref)<0);e[a].unshift(...p)}s(a,u,l)}),this.map(o,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[a]=c,n(a,c,l),c.length===0&&delete e[a]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(s=>r(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,s)=>{const n=e[s];return"metas"in n?r[s]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[s]=n,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ji;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Ji||(Ji={}));var Dr;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Dr||(Dr={}));var dt;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(dt||(dt={}));class ur{constructor(e,r={config:{}},s){var n,i;if(this.topic=e,this.params=r,this.socket=s,this.bindings={},this.state=me.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Xs(this,He.join,this.params,this.timeout),this.rejoinTimer=new ba(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=me.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=me.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=me.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=me.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=me.errored,this.rejoinTimer.scheduleTimeout())}),this._on(He.reply,{},(o,a)=>{this._trigger(this._replyEventName(a),o)}),this.presence=new Nr(this),this.broadcastEndpointURL=Ea(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var s,n,i;if(this.socket.isConnected()||this.socket.connect(),this.state==me.closed){const{config:{broadcast:o,presence:a,private:l}}=this.params,c=(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(d=>d.filter))!==null&&n!==void 0?n:[],u=!!this.bindings[Dr.PRESENCE]&&this.bindings[Dr.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},p={broadcast:o,presence:Object.assign(Object.assign({},a),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(d=>e==null?void 0:e(dt.CHANNEL_ERROR,d)),this._onClose(()=>e==null?void 0:e(dt.CLOSED)),this.updateJoinPayload(Object.assign({config:p},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:d})=>{var v;if(this.socket._isManualToken()||this.socket.setAuth(),d===void 0){e==null||e(dt.SUBSCRIBED);return}else{const b=this.bindings.postgres_changes,O=(v=b==null?void 0:b.length)!==null&&v!==void 0?v:0,y=[];for(let k=0;k<O;k++){const w=b[k],{filter:{event:A,schema:x,table:J,filter:Q}}=w,ve=d&&d[k];if(ve&&ve.event===A&&ur.isFilterValueEqual(ve.schema,x)&&ur.isFilterValueEqual(ve.table,J)&&ur.isFilterValueEqual(ve.filter,Q))y.push(Object.assign(Object.assign({},w),{id:ve.id}));else{this.unsubscribe(),this.state=me.errored,e==null||e(dt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e(dt.SUBSCRIBED);return}}).receive("error",d=>{this.state=me.errored,e==null||e(dt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(dt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,s){return this.state===me.joined&&e===Dr.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,r,s)}async httpSend(e,r,s={}){var n;if(r==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},a=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(n=s.timeout)!==null&&n!==void 0?n:this.timeout);if(a.status===202)return{success:!0};let l=a.statusText;try{const c=await a.json();l=c.error||c.message||l}catch{}return Promise.reject(new Error(l))}async send(e,r={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=e,a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=c.body)===null||n===void 0?void 0:n.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const c=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=me.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(He.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new Xs(this,He.leave,{},e),s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=me.closed,this.bindings={}}async _fetchWithTimeout(e,r,s){const n=new AbortController,i=setTimeout(()=>n.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(i),o}_push(e,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Xs(this,e,r,s);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>bu){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,s){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,s){var n,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=He;if(s&&[a,l,c,u].indexOf(o)>=0&&s!==this._joinRef())return;let p=this._onMessage(o,r,s);if(r&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(d=>{var v,b,O;return((v=d.filter)===null||v===void 0?void 0:v.event)==="*"||((O=(b=d.filter)===null||b===void 0?void 0:b.event)===null||O===void 0?void 0:O.toLocaleLowerCase())===o}).map(d=>d.callback(p,s)):(i=this.bindings[o])===null||i===void 0||i.filter(d=>{var v,b,O,y,k,w;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in d){const A=d.id,x=(v=d.filter)===null||v===void 0?void 0:v.event;return A&&((b=r.ids)===null||b===void 0?void 0:b.includes(A))&&(x==="*"||(x==null?void 0:x.toLocaleLowerCase())===((O=r.data)===null||O===void 0?void 0:O.type.toLocaleLowerCase()))}else{const A=(k=(y=d==null?void 0:d.filter)===null||y===void 0?void 0:y.event)===null||k===void 0?void 0:k.toLocaleLowerCase();return A==="*"||A===((w=r==null?void 0:r.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return d.type.toLocaleLowerCase()===o}).map(d=>{if(typeof p=="object"&&"ids"in p){const v=p.data,{schema:b,table:O,commit_timestamp:y,type:k,errors:w}=v;p=Object.assign(Object.assign({},{schema:b,table:O,commit_timestamp:y,eventType:k,new:{},old:{},errors:w}),this._getPayloadRecords(v))}d.callback(p,s)})}_isClosed(){return this.state===me.closed}_isJoined(){return this.state===me.joined}_isJoining(){return this.state===me.joining}_isLeaving(){return this.state===me.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,s){const n=e.toLocaleLowerCase(),i={type:n,filter:r,callback:s};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,r){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&ur.isEqual(n.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const s in e)if(e[s]!==r[s])return!1;return!0}static isFilterValueEqual(e,r){return(e??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(He.close,{},e)}_onError(e){this._on(He.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=me.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Wi(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Wi(e.columns,e.old_record)),r}}const Zs=()=>{},is={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},xu=[1e3,2e3,5e3,1e4],Cu=1e4,Iu=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Pu{constructor(e,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=En,this.transport=null,this.heartbeatIntervalMs=is.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Zs,this.ref=0,this.reconnectTimer=null,this.vsn=Vi,this.logger=Zs,this.conn=null,this.sendBuffer=[],this.serializer=new Su,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>n?(...i)=>n(...i):(...i)=>fetch(...i),!(!((s=r==null?void 0:r.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${kn.websocket}`,this.httpEndpoint=Ea(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=vu.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,s){this.logger(e,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Rt.connecting:return qt.Connecting;case Rt.open:return qt.Open;case Rt.closing:return qt.Closing;default:return qt.Closed}}isConnected(){return this.connectionState()===qt.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(i=>i.topic===s);if(n)return n;{const i=new ur(`realtime:${e}`,r,this);return this.channels.push(i),i}}push(e){const{topic:r,event:s,payload:n,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${r} ${s} (${i})`,n),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(yu,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},is.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:n,payload:i,ref:o}=r,a=o?`(${o})`:"",l=i.status||"";this.log("receive",`${l} ${s} ${n} ${a}`.trim(),i),this.channels.filter(c=>c._isMember(s)).forEach(c=>c._trigger(n,i,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Rt.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Rt.open||this.conn.readyState===Rt.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(He.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${e}${s}${n}`}_workerObjectUrl(e){let r;if(e)r=e;else{const s=new Blob([Iu],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r,s=!1;if(e)r=e,s=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(n){this.log("error","Error fetching access token from callback",n),r=this.accessTokenValue}else r=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:wu};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(He.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(r)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new ba(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},is.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,s,n,i,o,a,l,c,u,h,p,d;switch(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:En,this.heartbeatIntervalMs=(n=e==null?void 0:e.heartbeatIntervalMs)!==null&&n!==void 0?n:is.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(a=e==null?void 0:e.heartbeatCallback)!==null&&a!==void 0?a:Zs,this.vsn=(l=e==null?void 0:e.vsn)!==null&&l!==void 0?l:Vi,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=e==null?void 0:e.reconnectAfterMs)!==null&&c!==void 0?c:v=>xu[v-1]||Cu,this.vsn){case ya:this.encode=(u=e==null?void 0:e.encode)!==null&&u!==void 0?u:(v,b)=>b(JSON.stringify(v)),this.decode=(h=e==null?void 0:e.decode)!==null&&h!==void 0?h:(v,b)=>b(JSON.parse(v));break;case _u:this.encode=(p=e==null?void 0:e.encode)!==null&&p!==void 0?p:this.serializer.encode.bind(this.serializer),this.decode=(d=e==null?void 0:e.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var Vr=class extends Error{constructor(t,e){var r;super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((r=e.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function $u(t,e,r){const s=new URL(e,t);if(r)for(const[n,i]of Object.entries(r))i!==void 0&&s.searchParams.set(n,i);return s.toString()}async function ju(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function Uu(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:r,path:s,query:n,body:i,headers:o}){const a=$u(t.baseUrl,s,n),l=await ju(t.auth),c=await e(a,{method:r,headers:{...i?{"Content-Type":"application/json"}:{},...l,...o},body:i?JSON.stringify(i):void 0}),u=await c.text(),h=(c.headers.get("content-type")||"").includes("application/json"),p=h&&u?JSON.parse(u):u;if(!c.ok){const d=h?p:void 0,v=d==null?void 0:d.error;throw new Vr((v==null?void 0:v.message)??`Request failed with status ${c.status}`,{status:c.status,icebergType:v==null?void 0:v.type,icebergCode:v==null?void 0:v.code,details:d})}return{status:c.status,headers:c.headers,data:p}}}}function os(t){return t.join("")}var Nu=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:os(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(t,e){const r={namespace:t.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${os(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${os(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${os(t.namespace)}`}),!0}catch(e){if(e instanceof Vr&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(r){if(r instanceof Vr&&r.status===409)return;throw r}}};function Xt(t){return t.join("")}var Du=class{constructor(t,e="",r){this.client=t,this.prefix=e,this.accessDelegation=r}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Xt(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Xt(t.namespace)}/tables`,body:e,headers:r})).data.metadata}async updateTable(t,e){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Xt(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Xt(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Xt(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Xt(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(r){if(r instanceof Vr&&r.status===404)return!1;throw r}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(r){if(r instanceof Vr&&r.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw r}}},Lu=class{constructor(t){var s;let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const r=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=Uu({baseUrl:r,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=(s=t.accessDelegation)==null?void 0:s.join(","),this.namespaceOps=new Nu(this.client,e),this.tableOps=new Du(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},Ms=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function ue(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var Bu=class extends Ms{constructor(t,e,r){super(t),this.name="StorageApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Rn=class extends Ms{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};const ei=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Mu=()=>Response,An=t=>{if(Array.isArray(t))return t.map(r=>An(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,s])=>{const n=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=An(s)}),e},qu=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Fu=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function Wr(t){"@babel/helpers - typeof";return Wr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wr(t)}function Ku(t,e){if(Wr(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,e);if(Wr(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vu(t){var e=Ku(t,"string");return Wr(e)=="symbol"?e:e+""}function Wu(t,e,r){return(e=Vu(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Gi(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function M(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Gi(Object(r),!0).forEach(function(s){Wu(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Gi(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}const en=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},Hu=async(t,e,r)=>{t instanceof await Mu()&&!(r!=null&&r.noResolveJson)?t.json().then(s=>{const n=t.status||500,i=(s==null?void 0:s.statusCode)||n+"";e(new Bu(en(s),n,i))}).catch(s=>{e(new Rn(en(s),s))}):e(new Rn(en(t),t))},Ju=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!s?n:(qu(s)?(n.headers=M({"Content-Type":"application/json"},e==null?void 0:e.headers),n.body=JSON.stringify(s)):n.body=s,e!=null&&e.duplex&&(n.duplex=e.duplex),M(M({},n),r))};async function es(t,e,r,s,n,i){return new Promise((o,a)=>{t(r,Ju(e,s,n,i)).then(l=>{if(!l.ok)throw l;return s!=null&&s.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>Hu(l,a,s))})}async function Hr(t,e,r,s){return es(t,"GET",e,r,s)}async function We(t,e,r,s,n){return es(t,"POST",e,s,n,r)}async function On(t,e,r,s,n){return es(t,"PUT",e,s,n,r)}async function Gu(t,e,r,s){return es(t,"HEAD",e,M(M({},r),{},{noResolveJson:!0}),s)}async function ti(t,e,r,s,n){return es(t,"DELETE",e,s,n,r)}var zu=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(ue(e))return{data:null,error:e};throw e}}};let ka;ka=Symbol.toStringTag;var Qu=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[ka]="BlobDownloadBuilder",this.promise=null}asStream(){return new zu(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(ue(e))return{data:null,error:e};throw e}}};const Yu={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},zi={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Xu=class{constructor(t,e={},r,s){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=r,this.fetch=ei(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,e,r,s){var n=this;try{let i;const o=M(M({},zi),s);let a=M(M({},n.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",n.encodeMetadata(l)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),l&&!i.has("metadata")&&i.append("metadata",n.encodeMetadata(l))):(i=r,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=n.toBase64(n.encodeMetadata(l))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),s!=null&&s.headers&&(a=M(M({},a),s.headers));const c=n._removeEmptyFolders(e),u=n._getFinalPath(c),h=await(t=="PUT"?On:We)(n.fetch,`${n.url}/object/${u}`,i,M({headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:c,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(n.shouldThrowOnError)throw i;if(ue(i))return{data:null,error:i};throw i}}async upload(t,e,r){return this.uploadOrUpdate("POST",t,e,r)}async uploadToSignedUrl(t,e,r,s){var n=this;const i=n._removeEmptyFolders(t),o=n._getFinalPath(i),a=new URL(n.url+`/object/upload/sign/${o}`);a.searchParams.set("token",e);try{let l;const c=M({upsert:zi.upsert},s),u=M(M({},n.headers),{"x-upsert":String(c.upsert)});return typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType),{data:{path:i,fullPath:(await On(n.fetch,a.toString(),l,{headers:u})).Key},error:null}}catch(l){if(n.shouldThrowOnError)throw l;if(ue(l))return{data:null,error:l};throw l}}async createSignedUploadUrl(t,e){var r=this;try{let s=r._getFinalPath(t);const n=M({},r.headers);e!=null&&e.upsert&&(n["x-upsert"]="true");const i=await We(r.fetch,`${r.url}/object/upload/sign/${s}`,{},{headers:n}),o=new URL(r.url+i.url),a=o.searchParams.get("token");if(!a)throw new Ms("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:a},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(ue(s))return{data:null,error:s};throw s}}async update(t,e,r){return this.uploadOrUpdate("PUT",t,e,r)}async move(t,e,r){var s=this;try{return{data:await We(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r==null?void 0:r.destinationBucket},{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(ue(n))return{data:null,error:n};throw n}}async copy(t,e,r){var s=this;try{return{data:{path:(await We(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r==null?void 0:r.destinationBucket},{headers:s.headers})).Key},error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(ue(n))return{data:null,error:n};throw n}}async createSignedUrl(t,e,r){var s=this;try{let n=s._getFinalPath(t),i=await We(s.fetch,`${s.url}/object/sign/${n}`,M({expiresIn:e},r!=null&&r.transform?{transform:r.transform}:{}),{headers:s.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${s.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(ue(n))return{data:null,error:n};throw n}}async createSignedUrls(t,e,r){var s=this;try{const n=await We(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:e,paths:t},{headers:s.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:n.map(o=>M(M({},o),{},{signedUrl:o.signedURL?encodeURI(`${s.url}${o.signedURL}${i}`):null})),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(ue(n))return{data:null,error:n};throw n}}download(t,e){const r=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),n=s?`?${s}`:"",i=this._getFinalPath(t),o=()=>Hr(this.fetch,`${this.url}/${r}/${i}${n}`,{headers:this.headers,noResolveJson:!0});return new Qu(o,this.shouldThrowOnError)}async info(t){var e=this;const r=e._getFinalPath(t);try{return{data:An(await Hr(e.fetch,`${e.url}/object/info/${r}`,{headers:e.headers})),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(ue(s))return{data:null,error:s};throw s}}async exists(t){var e=this;const r=e._getFinalPath(t);try{return await Gu(e.fetch,`${e.url}/object/${r}`,{headers:e.headers}),{data:!0,error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(ue(s)&&s instanceof Rn){const n=s.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:s}}throw s}}getPublicUrl(t,e){const r=this._getFinalPath(t),s=[],n=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";n!==""&&s.push(n);const i=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",o=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});o!==""&&s.push(o);let a=s.join("&");return a!==""&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${a}`)}}}async remove(t){var e=this;try{return{data:await ti(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ue(r))return{data:null,error:r};throw r}}async list(t,e,r){var s=this;try{const n=M(M(M({},Yu),e),{},{prefix:t||""});return{data:await We(s.fetch,`${s.url}/object/list/${s.bucketId}`,n,{headers:s.headers},r),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(ue(n))return{data:null,error:n};throw n}}async listV2(t,e){var r=this;try{const s=M({},t);return{data:await We(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,s,{headers:r.headers},e),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(ue(s))return{data:null,error:s};throw s}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const Ta="2.89.0",Ra={"X-Client-Info":`storage-js/${Ta}`};var Zu=class{constructor(t,e={},r,s){this.shouldThrowOnError=!1;const n=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase.")),this.url=n.href.replace(/\/$/,""),this.headers=M(M({},Ra),e),this.fetch=ei(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){var e=this;try{const r=e.listBucketOptionsToQueryString(t);return{data:await Hr(e.fetch,`${e.url}/bucket${r}`,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ue(r))return{data:null,error:r};throw r}}async getBucket(t){var e=this;try{return{data:await Hr(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ue(r))return{data:null,error:r};throw r}}async createBucket(t,e={public:!1}){var r=this;try{return{data:await We(r.fetch,`${r.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(ue(s))return{data:null,error:s};throw s}}async updateBucket(t,e){var r=this;try{return{data:await On(r.fetch,`${r.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(ue(s))return{data:null,error:s};throw s}}async emptyBucket(t){var e=this;try{return{data:await We(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ue(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await ti(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ue(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},eh=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=M(M({},Ra),e),this.fetch=ei(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await We(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ue(r))return{data:null,error:r};throw r}}async listBuckets(t){var e=this;try{const r=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&r.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&r.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&r.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&r.set("sortOrder",t.sortOrder),t!=null&&t.search&&r.set("search",t.search);const s=r.toString(),n=s?`${e.url}/bucket?${s}`:`${e.url}/bucket`;return{data:await Hr(e.fetch,n,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ue(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await ti(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ue(r))return{data:null,error:r};throw r}}from(t){var e=this;if(!Fu(t))throw new Ms("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new Lu({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(r,{get(n,i){const o=n[i];return typeof o!="function"?o:async(...a)=>{try{return{data:await o.apply(n,a),error:null}}catch(l){if(s)throw l;return{data:null,error:l}}}}})}};const ri={"X-Client-Info":`storage-js/${Ta}`,"Content-Type":"application/json"};var Aa=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Le(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}var tn=class extends Aa{constructor(t,e,r){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},th=class extends Aa{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}};const si=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),rh=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Qi=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),sh=async(t,e,r)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(r!=null&&r.noResolveJson)){const s=t.status||500,n=t;if(typeof n.json=="function")n.json().then(i=>{const o=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||s+"";e(new tn(Qi(i),s,o))}).catch(()=>{const i=s+"";e(new tn(n.statusText||`HTTP ${s} error`,s,i))});else{const i=s+"";e(new tn(n.statusText||`HTTP ${s} error`,s,i))}}else e(new th(Qi(t),t))},nh=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return s?(rh(s)?(n.headers=M({"Content-Type":"application/json"},e==null?void 0:e.headers),n.body=JSON.stringify(s)):n.body=s,M(M({},n),r)):n};async function ih(t,e,r,s,n,i){return new Promise((o,a)=>{t(r,nh(e,s,n,i)).then(l=>{if(!l.ok)throw l;if(s!=null&&s.noResolveJson)return l;const c=l.headers.get("content-type");return!c||!c.includes("application/json")?{}:l.json()}).then(l=>o(l)).catch(l=>sh(l,a,s))})}async function Be(t,e,r,s,n){return ih(t,"POST",e,s,n,r)}var oh=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=M(M({},ri),e),this.fetch=si(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(t){var e=this;try{return{data:await Be(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Le(r))return{data:null,error:r};throw r}}async getIndex(t,e){var r=this;try{return{data:await Be(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Le(s))return{data:null,error:s};throw s}}async listIndexes(t){var e=this;try{return{data:await Be(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Le(r))return{data:null,error:r};throw r}}async deleteIndex(t,e){var r=this;try{return{data:await Be(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers})||{},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Le(s))return{data:null,error:s};throw s}}},ah=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=M(M({},ri),e),this.fetch=si(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(t){var e=this;try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Be(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Le(r))return{data:null,error:r};throw r}}async getVectors(t){var e=this;try{return{data:await Be(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Le(r))return{data:null,error:r};throw r}}async listVectors(t){var e=this;try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:await Be(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Le(r))return{data:null,error:r};throw r}}async queryVectors(t){var e=this;try{return{data:await Be(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Le(r))return{data:null,error:r};throw r}}async deleteVectors(t){var e=this;try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Be(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Le(r))return{data:null,error:r};throw r}}},lh=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=M(M({},ri),e),this.fetch=si(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await Be(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Le(r))return{data:null,error:r};throw r}}async getBucket(t){var e=this;try{return{data:await Be(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Le(r))return{data:null,error:r};throw r}}async listBuckets(t={}){var e=this;try{return{data:await Be(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Le(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await Be(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Le(r))return{data:null,error:r};throw r}}},ch=class extends lh{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new uh(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,r=this;return e().call(r,t)}async getBucket(t){var e=()=>super.getBucket,r=this;return e().call(r,t)}async listBuckets(t={}){var e=()=>super.listBuckets,r=this;return e().call(r,t)}async deleteBucket(t){var e=()=>super.deleteBucket,r=this;return e().call(r,t)}},uh=class extends oh{constructor(t,e,r,s){super(t,e,s),this.vectorBucketName=r}async createIndex(t){var e=()=>super.createIndex,r=this;return e().call(r,M(M({},t),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,r=this;return e().call(r,M(M({},t),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,r=this;return e().call(r,r.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,r=this;return e().call(r,r.vectorBucketName,t)}index(t){return new hh(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},hh=class extends ah{constructor(t,e,r,s,n){super(t,e,n),this.vectorBucketName=r,this.indexName=s}async putVectors(t){var e=()=>super.putVectors,r=this;return e().call(r,M(M({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(t){var e=()=>super.getVectors,r=this;return e().call(r,M(M({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,r=this;return e().call(r,M(M({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,r=this;return e().call(r,M(M({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,r=this;return e().call(r,M(M({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},dh=class extends Zu{constructor(t,e={},r,s){super(t,e,r,s)}from(t){return new Xu(this.url,this.headers,t,this.fetch)}get vectors(){return new ch(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new eh(this.url+"/iceberg",this.headers,this.fetch)}};const Oa="2.89.0",lr=30*1e3,xn=3,rn=xn*lr,fh="http://localhost:9999",ph="supabase.auth.token",gh={"X-Client-Info":`gotrue-js/${Oa}`},Cn="X-Supabase-Api-Version",xa={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},vh=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,mh=10*60*1e3;class Jr extends Error{constructor(e,r,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function N(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class wh extends Jr{constructor(e,r,s){super(e,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function _h(t){return N(t)&&t.name==="AuthApiError"}class Ft extends Jr{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class yt extends Jr{constructor(e,r,s,n){super(e,s,n),this.name=r,this.status=s}}class Ue extends yt{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function yh(t){return N(t)&&t.name==="AuthSessionMissingError"}class Zt extends yt{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class as extends yt{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ls extends yt{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function bh(t){return N(t)&&t.name==="AuthImplicitGrantRedirectError"}class Yi extends yt{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Sh extends yt{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class In extends yt{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function sn(t){return N(t)&&t.name==="AuthRetryableFetchError"}class Xi extends yt{constructor(e,r,s){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class Pn extends yt{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const ks="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Zi=` 	
\r=`.split(""),Eh=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Zi.length;e+=1)t[Zi[e].charCodeAt(0)]=-2;for(let e=0;e<ks.length;e+=1)t[ks[e].charCodeAt(0)]=e;return t})();function eo(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(ks[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(ks[s]),e.queuedBits-=6}}function Ca(t,e,r){const s=Eh[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function to(t){const e=[],r=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=o=>{Rh(o,s,r)};for(let o=0;o<t.length;o+=1)Ca(t.charCodeAt(o),n,i);return e.join("")}function kh(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Th(t,e){for(let r=0;r<t.length;r+=1){let s=t.charCodeAt(r);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(t.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}kh(s,e)}}function Rh(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let s=1;s<6;s+=1)if(!(t>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function vr(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)Ca(t.charCodeAt(n),r,s);return new Uint8Array(e)}function Ah(t){const e=[];return Th(t,r=>e.push(r)),new Uint8Array(e)}function Kt(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};return t.forEach(n=>eo(n,r,s)),eo(null,r,s),e.join("")}function Oh(t){return Math.round(Date.now()/1e3)+t}function xh(){return Symbol("auth-callback")}const ye=()=>typeof window<"u"&&typeof document<"u",Nt={tested:!1,writable:!1},Ia=()=>{if(!ye())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Nt.tested)return Nt.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Nt.tested=!0,Nt.writable=!0}catch{Nt.tested=!0,Nt.writable=!1}return Nt.writable};function Ch(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return r.searchParams.forEach((s,n)=>{e[n]=s}),e}const Pa=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Ih=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",cr=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},Dt=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},_e=async(t,e)=>{await t.removeItem(e)};class qs{constructor(){this.promise=new qs.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}qs.promiseConstructor=Promise;function nn(t){const e=t.split(".");if(e.length!==3)throw new Pn("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!vh.test(e[s]))throw new Pn("JWT not in base64url format");return{header:JSON.parse(to(e[0])),payload:JSON.parse(to(e[1])),signature:vr(e[2]),raw:{header:e[0],payload:e[1]}}}async function Ph(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function $h(t,e){return new Promise((s,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){s(o);return}}catch(o){if(!e(i,o)){n(o);return}}})()})}function jh(t){return("0"+t.toString(16)).substr(-2)}function Uh(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let n="";for(let i=0;i<56;i++)n+=r.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,jh).join("")}async function Nh(t){const r=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(s);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}async function Dh(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await Nh(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function er(t,e,r=!1){const s=Uh();let n=s;r&&(n+="/PASSWORD_RECOVERY"),await cr(t,`${e}-code-verifier`,n);const i=await Dh(s);return[i,s===i?"plain":"s256"]}const Lh=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Bh(t){const e=t.headers.get(Cn);if(!e||!e.match(Lh))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Mh(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function qh(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Fh=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function tr(t){if(!Fh.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function on(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Kh(t,e){return new Proxy(t,{get:(r,s,n)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const i=s.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,s,n)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,s,n)}})}function ro(t){return JSON.parse(JSON.stringify(t))}const Mt=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Vh=[502,503,504];async function so(t){var e;if(!Ih(t))throw new In(Mt(t),0);if(Vh.includes(t.status))throw new In(Mt(t),t.status);let r;try{r=await t.json()}catch(i){throw new Ft(Mt(i),i)}let s;const n=Bh(t);if(n&&n.getTime()>=xa["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new Xi(Mt(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Ue}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Xi(Mt(r),t.status,r.weak_password.reasons);throw new wh(Mt(r),t.status||500,s)}const Wh=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};async function B(t,e,r,s){var n;const i=Object.assign({},s==null?void 0:s.headers);i[Cn]||(i[Cn]=xa["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(n=s==null?void 0:s.query)!==null&&n!==void 0?n:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await Hh(t,e,r+a,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function Hh(t,e,r,s,n,i){const o=Wh(e,s,n,i);let a;try{a=await t(r,Object.assign({},o))}catch(l){throw console.error(l),new In(Mt(l),0)}if(a.ok||await so(a),s!=null&&s.noResolveJson)return a;try{return await a.json()}catch(l){await so(l)}}function Ve(t){var e;let r=null;zh(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=Oh(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:s},error:null}}function no(t){const e=Ve(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Ot(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Jh(t){return{data:t,error:null}}function Gh(t){const{action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i}=t,o=Bs(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function io(t){return t}function zh(t){return t.access_token&&t.refresh_token&&t.expires_in}const an=["global","local","others"];class Qh{constructor({url:e="",headers:r={},fetch:s}){this.url=e,this.headers=r,this.fetch=Pa(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=an[0]){if(an.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${an.join(", ")}`);try{return await B(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(N(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,r={}){try{return await B(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ot})}catch(s){if(N(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:r}=e,s=Bs(e,["options"]),n=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(n.new_email=s==null?void 0:s.newEmail,delete n.newEmail),await B(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Gh,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(N(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await B(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ot})}catch(r){if(N(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,s,n,i,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await B(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(i=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:io});if(u.error)throw u.error;const h=await u.json(),p=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,d=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return d.length>0&&(d.forEach(v=>{const b=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),O=JSON.parse(v.split(";")[1].split("=")[1]);c[`${O}Page`]=b}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(N(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){tr(e);try{return await B(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ot})}catch(r){if(N(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){tr(e);try{return await B(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Ot})}catch(s){if(N(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,r=!1){tr(e);try{return await B(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ot})}catch(s){if(N(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){tr(e.userId);try{const{data:r,error:s}=await B(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:s}}catch(r){if(N(r))return{data:null,error:r};throw r}}async _deleteFactor(e){tr(e.userId),tr(e.id);try{return{data:await B(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(N(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,s,n,i,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await B(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(i=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:io});if(u.error)throw u.error;const h=await u.json(),p=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,d=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return d.length>0&&(d.forEach(v=>{const b=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),O=JSON.parse(v.split(";")[1].split("=")[1]);c[`${O}Page`]=b}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(N(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(e){try{return await B(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(N(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await B(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(N(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await B(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(N(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await B(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(N(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await B(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(N(r))return{data:null,error:r};throw r}}}function oo(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const rr={debug:!!(globalThis&&Ia()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class $a extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Yh extends $a{}async function Xh(t,e,r){rr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),rr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){rr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{rr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw rr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new Yh(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(rr.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function Zh(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function ja(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function ed(t){return parseInt(t,16)}function td(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function rd(t){var e;const{chainId:r,domain:s,expirationTime:n,issuedAt:i=new Date,nonce:o,notBefore:a,requestId:l,resources:c,scheme:u,uri:h,version:p}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(p!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${p}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const d=ja(t.address),v=u?`${u}://${s}`:s,b=t.statement?`${t.statement}
`:"",O=`${v} wants you to sign in with your Ethereum account:
${d}

${b}`;let y=`URI: ${h}
Version: ${p}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(n&&(y+=`
Expiration Time: ${n.toISOString()}`),a&&(y+=`
Not Before: ${a.toISOString()}`),l&&(y+=`
Request ID: ${l}`),c){let k=`
Resources:`;for(const w of c){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);k+=`
- ${w}`}y+=k}return`${O}
${y}`}class pe extends Error{constructor({message:e,code:r,cause:s,name:n}){var i;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(i=n??(s instanceof Error?s.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class Ts extends pe{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function sd({error:t,options:e}){var r,s,n;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new pe({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new pe({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new pe({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new pe({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new pe({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new pe({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(a=>a.type==="public-key").length===0?new pe({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new pe({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const o=window.location.hostname;if(Ua(o)){if(i.rp.id!==o)return new pe({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new pe({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new pe({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new pe({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new pe({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function nd({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new pe({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new pe({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(Ua(s)){if(r.rpId!==s)return new pe({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new pe({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new pe({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new pe({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class id{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const od=new id;function ad(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:s}=t,n=Bs(t,["challenge","user","excludeCredentials"]),i=vr(e).buffer,o=Object.assign(Object.assign({},r),{id:vr(r.id).buffer}),a=Object.assign(Object.assign({},n),{challenge:i,user:o});if(s&&s.length>0){a.excludeCredentials=new Array(s.length);for(let l=0;l<s.length;l++){const c=s[l];a.excludeCredentials[l]=Object.assign(Object.assign({},c),{id:vr(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return a}function ld(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,s=Bs(t,["challenge","allowCredentials"]),n=vr(e).buffer,i=Object.assign(Object.assign({},s),{challenge:n});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const a=r[o];i.allowCredentials[o]=Object.assign(Object.assign({},a),{id:vr(a.id).buffer,type:a.type||"public-key",transports:a.transports})}}return i}function cd(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:Kt(new Uint8Array(t.response.attestationObject)),clientDataJSON:Kt(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function ud(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,s=t.getClientExtensionResults(),n=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Kt(new Uint8Array(n.authenticatorData)),clientDataJSON:Kt(new Uint8Array(n.clientDataJSON)),signature:Kt(new Uint8Array(n.signature)),userHandle:n.userHandle?Kt(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Ua(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function ao(){var t,e;return!!(ye()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function hd(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Ts("Browser returned unexpected credential type",e)}:{data:null,error:new Ts("Empty credential response",e)}}catch(e){return{data:null,error:sd({error:e,options:t})}}}async function dd(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Ts("Browser returned unexpected credential type",e)}:{data:null,error:new Ts("Empty credential response",e)}}catch(e){return{data:null,error:nd({error:e,options:t})}}}const fd={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},pd={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Rs(...t){const e=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),r=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),s={};for(const n of t)if(n)for(const i in n){const o=n[i];if(o!==void 0)if(Array.isArray(o))s[i]=o;else if(r(o))s[i]=o;else if(e(o)){const a=s[i];e(a)?s[i]=Rs(a,o):s[i]=Rs(o)}else s[i]=o}return s}function gd(t,e){return Rs(fd,t,e||{})}function vd(t,e){return Rs(pd,t,e||{})}class md{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:s,signal:n},i){try{const{data:o,error:a}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!o)return{data:null,error:a};const l=n??od.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:c}=o.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${s}`),c.displayName||(c.displayName=c.name)}switch(o.webauthn.type){case"create":{const c=gd(o.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:u,error:h}=await hd({publicKey:c,signal:l});return u?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}case"request":{const c=vd(o.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:u,error:h}=await dd(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:c,signal:l}));return u?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}}}catch(o){return N(o)?{data:null,error:o}:{data:null,error:new Ft("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},i){if(!r)return{data:null,error:new Jr("rpId is required for WebAuthn authentication")};try{if(!ao())return{data:null,error:new Ft("Browser does not support WebAuthn",null)};const{data:o,error:a}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:s},signal:n},{request:i});if(!o)return{data:null,error:a};const{webauthn:l}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:l.type,rpId:r,rpOrigins:s,credential_response:l.credential_response}})}catch(o){return N(o)?{data:null,error:o}:{data:null,error:new Ft("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},i){if(!r)return{data:null,error:new Jr("rpId is required for WebAuthn registration")};try{if(!ao())return{data:null,error:new Ft("Browser does not support WebAuthn",null)};const{data:o,error:a}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(u=>{var h;return(h=u.data)===null||h===void 0?void 0:h.all.find(p=>p.factor_type==="webauthn"&&p.friendly_name===e&&p.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:a};const{data:l,error:c}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:n},{create:i});return l?this._verify({factorId:o.id,challengeId:l.challengeId,webauthn:{rpId:r,rpOrigins:s,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:c}}catch(o){return N(o)?{data:null,error:o}:{data:null,error:new Ft("Unexpected error in register",o)}}}}Zh();const wd={url:fh,storageKey:ph,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:gh,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function lo(t,e,r){return await r()}const sr={};class Gr{get jwks(){var e,r;return(r=(e=sr[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){sr[this.storageKey]=Object.assign(Object.assign({},sr[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=sr[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){sr[this.storageKey]=Object.assign(Object.assign({},sr[this.storageKey]),{cachedAt:e})}constructor(e){var r,s,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},wd),e);if(this.storageKey=i.storageKey,this.instanceID=(r=Gr.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Gr.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&ye()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Qh({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Pa(i.fetch),this.lock=i.lock||lo,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:this.persistSession&&ye()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=Xh:this.lock=lo,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new md(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:Ia()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=oo(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=oo(this.memoryStorage)),ye()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Oa}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},s="none";if(ye()&&(r=Ch(window.location.href),this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce")),ye()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:i}=await this._getSessionFromURL(r,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),bh(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return N(r)?this._returnResult({error:r}):this._returnResult({error:new Ft("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,s,n;try{const i=await B(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:Ve}),{data:o,error:a}=i;if(a||!o)return this._returnResult({data:{user:null,session:null},error:a});const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(i){if(N(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var r,s,n;try{let i;if("email"in e){const{email:u,password:h,options:p}=e;let d=null,v=null;this.flowType==="pkce"&&([d,v]=await er(this.storage,this.storageKey)),i=await B(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:u,password:h,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:d,code_challenge_method:v},xform:Ve})}else if("phone"in e){const{phone:u,password:h,options:p}=e;i=await B(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=p==null?void 0:p.data)!==null&&s!==void 0?s:{},channel:(n=p==null?void 0:p.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:Ve})}else throw new as("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return await _e(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:a});const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(i){if(await _e(this.storage,`${this.storageKey}-code-verifier`),N(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let r;if("email"in e){const{email:i,password:o,options:a}=e;r=await B(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:no})}else if("phone"in e){const{phone:i,password:o,options:a}=e;r=await B(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:no})}else throw new as("You must provide either an email or phone number and a password");const{data:s,error:n}=r;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!s||!s.session||!s.user){const i=new Zt;return this._returnResult({data:{user:null,session:null},error:i})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(N(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,s,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,s,n,i,o,a,l,c,u,h,p;let d,v;if("message"in e)d=e.message,v=e.signature;else{const{chain:b,wallet:O,statement:y,options:k}=e;let w;if(ye())if(typeof O=="object")w=O;else{const be=window;if("ethereum"in be&&typeof be.ethereum=="object"&&"request"in be.ethereum&&typeof be.ethereum.request=="function")w=be.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof O!="object"||!(k!=null&&k.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=O}const A=new URL((r=k==null?void 0:k.url)!==null&&r!==void 0?r:window.location.href),x=await w.request({method:"eth_requestAccounts"}).then(be=>be).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!x||x.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const J=ja(x[0]);let Q=(s=k==null?void 0:k.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!Q){const be=await w.request({method:"eth_chainId"});Q=ed(be)}const ve={domain:A.host,address:J,statement:y,uri:A.href,version:"1",chainId:Q,nonce:(n=k==null?void 0:k.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(o=(i=k==null?void 0:k.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(a=k==null?void 0:k.signInWithEthereum)===null||a===void 0?void 0:a.expirationTime,notBefore:(l=k==null?void 0:k.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(c=k==null?void 0:k.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(u=k==null?void 0:k.signInWithEthereum)===null||u===void 0?void 0:u.resources};d=rd(ve),v=await w.request({method:"personal_sign",params:[td(d),J]})}try{const{data:b,error:O}=await B(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:d,signature:v},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Ve});if(O)throw O;if(!b||!b.session||!b.user){const y=new Zt;return this._returnResult({data:{user:null,session:null},error:y})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:O})}catch(b){if(N(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async signInWithSolana(e){var r,s,n,i,o,a,l,c,u,h,p,d;let v,b;if("message"in e)v=e.message,b=e.signature;else{const{chain:O,wallet:y,statement:k,options:w}=e;let A;if(ye())if(typeof y=="object")A=y;else{const J=window;if("solana"in J&&typeof J.solana=="object"&&("signIn"in J.solana&&typeof J.solana.signIn=="function"||"signMessage"in J.solana&&typeof J.solana.signMessage=="function"))A=J.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");A=y}const x=new URL((r=w==null?void 0:w.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in A&&A.signIn){const J=await A.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:x.host,uri:x.href}),k?{statement:k}:null));let Q;if(Array.isArray(J)&&J[0]&&typeof J[0]=="object")Q=J[0];else if(J&&typeof J=="object"&&"signedMessage"in J&&"signature"in J)Q=J;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in Q&&"signature"in Q&&(typeof Q.signedMessage=="string"||Q.signedMessage instanceof Uint8Array)&&Q.signature instanceof Uint8Array)v=typeof Q.signedMessage=="string"?Q.signedMessage:new TextDecoder().decode(Q.signedMessage),b=Q.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in A)||typeof A.signMessage!="function"||!("publicKey"in A)||typeof A!="object"||!A.publicKey||!("toBase58"in A.publicKey)||typeof A.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${x.host} wants you to sign in with your Solana account:`,A.publicKey.toBase58(),...k?["",k,""]:[""],"Version: 1",`URI: ${x.href}`,`Issued At: ${(n=(s=w==null?void 0:w.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((i=w==null?void 0:w.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((a=w==null?void 0:w.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((c=w==null?void 0:w.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((h=(u=w==null?void 0:w.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...w.signInWithSolana.resources.map(Q=>`- ${Q}`)]:[]].join(`
`);const J=await A.signMessage(new TextEncoder().encode(v),"utf8");if(!J||!(J instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=J}}try{const{data:O,error:y}=await B(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:Kt(b)},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(d=e.options)===null||d===void 0?void 0:d.captchaToken}}:null),xform:Ve});if(y)throw y;if(!O||!O.session||!O.user){const k=new Zt;return this._returnResult({data:{user:null,session:null},error:k})}return O.session&&(await this._saveSession(O.session),await this._notifyAllSubscribers("SIGNED_IN",O.session)),this._returnResult({data:Object.assign({},O),error:y})}catch(O){if(N(O))return this._returnResult({data:{user:null,session:null},error:O});throw O}}async _exchangeCodeForSession(e){const r=await Dt(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/");try{if(!s&&this.flowType==="pkce")throw new Sh;const{data:i,error:o}=await B(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Ve});if(await _e(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const a=new Zt;return this._returnResult({data:{user:null,session:null,redirectType:null},error:a})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:o})}catch(i){if(await _e(this.storage,`${this.storageKey}-code-verifier`),N(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:r,provider:s,token:n,access_token:i,nonce:o}=e,a=await B(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Ve}),{data:l,error:c}=a;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l||!l.session||!l.user){const u=new Zt;return this._returnResult({data:{user:null,session:null},error:u})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:c})}catch(r){if(N(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,s,n,i,o;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await er(this.storage,this.storageKey));const{error:h}=await B(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await B(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u})}throw new as("You must provide either an email or phone number.")}catch(a){if(await _e(this.storage,`${this.storageKey}-code-verifier`),N(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async verifyOtp(e){var r,s;try{let n,i;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:a}=await B(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:Ve});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(n){if(N(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(e){var r,s,n,i,o;try{let a=null,l=null;this.flowType==="pkce"&&([a,l]=await er(this.storage,this.storageKey));const c=await B(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:l}),headers:this.headers,xform:Jh});return!((i=c.data)===null||i===void 0)&&i.url&&ye()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(a){if(await _e(this.storage,`${this.storageKey}-code-verifier`),N(a))return this._returnResult({data:null,error:a});throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;if(s)throw s;if(!r)throw new Ue;const{error:n}=await B(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(e){if(N(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:i}=e,{error:o}=await B(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:s,type:n,options:i}=e,{data:o,error:a}=await B(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a})}throw new as("You must provide either an email or phone number and a type")}catch(r){if(N(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await Dt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<rn:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const o=await Dt(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=on()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=Kh(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(e){try{return e?await B(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ot}):await this._useSession(async r=>{var s,n,i;const{data:o,error:a}=r;if(a)throw a;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ue}:await B(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:Ot})})}catch(r){if(N(r))return yh(r)&&(await this._removeSession(),await _e(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async s=>{const{data:n,error:i}=s;if(i)throw i;if(!n.session)throw new Ue;const o=n.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await er(this.storage,this.storageKey));const{data:c,error:u}=await B(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:Ot});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(s){if(await _e(this.storage,`${this.storageKey}-code-verifier`),N(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ue;const r=Date.now()/1e3;let s=r,n=!0,i=null;const{payload:o}=nn(e.access_token);if(o.exp&&(s=o.exp,n=s<=r),n){const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(r){if(N(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var s;if(!e){const{data:o,error:a}=r;if(a)throw a;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new Ue;const{data:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(N(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!ye())throw new ls("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ls(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Yi("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ls("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Yi("No code detected.");const{data:k,error:w}=await this._exchangeCodeForSession(e.code);if(w)throw w;const A=new URL(window.location.href);return A.searchParams.delete("code"),window.history.replaceState(window.history.state,"",A.toString()),{data:{session:k.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=e;if(!i||!a||!o||!c)throw new ls("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(a);let p=u+h;l&&(p=parseInt(l));const d=p-u;d*1e3<=lr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${h}s`);const v=p-h;u-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,p,u):u-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,p,u);const{data:b,error:O}=await this._getUser(i);if(O)throw O;const y={provider_token:s,provider_refresh_token:n,access_token:i,expires_in:h,expires_at:p,refresh_token:o,token_type:c,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:y,redirectType:e.type},error:null})}catch(s){if(N(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await Dt(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return this._returnResult({error:i});const o=(s=n.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(_h(a)&&(a.status===404||a.status===401||a.status===403)))return this._returnResult({error:a})}return e!=="others"&&(await this._removeSession(),await _e(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=xh(),s={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async r=>{var s,n;try{const{data:{session:i},error:o}=r;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await er(this.storage,this.storageKey,!0));try{return await B(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(await _e(this.storage,`${this.storageKey}-code-verifier`),N(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(N(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:s,error:n}=await this._useSession(async i=>{var o,a,l,c,u;const{data:h,error:p}=i;if(p)throw p;const d=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await B(this.fetch,"GET",d,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(n)throw n;return ye()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:e.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(N(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var s;try{const{error:n,data:{session:i}}=r;if(n)throw n;const{options:o,provider:a,token:l,access_token:c,nonce:u}=e,h=await B(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=i==null?void 0:i.access_token)!==null&&s!==void 0?s:void 0,body:{provider:a,id_token:l,access_token:c,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Ve}),{data:p,error:d}=h;return d?this._returnResult({data:{user:null,session:null},error:d}):!p||!p.session||!p.user?this._returnResult({data:{user:null,session:null},error:new Zt}):(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("USER_UPDATED",p.session)),this._returnResult({data:p,error:d}))}catch(n){if(await _e(this.storage,`${this.storageKey}-code-verifier`),N(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:o}=r;if(o)throw o;return await B(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(N(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await $h(async n=>(n>0&&await Ph(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await B(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ve})),(n,i)=>{const o=200*Math.pow(2,n);return i&&sn(i)&&Date.now()+o-s<lr})}catch(s){if(this._debug(r,"error",s),N(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",s),ye()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await Dt(this.storage,this.storageKey);if(n&&this.userStorage){let o=await Dt(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:n.user},await cr(this.userStorage,this.storageKey+"-user",o)),n.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:on()}else if(n&&!n.user&&!n.user){const o=await Dt(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(n.user=o.user,await _e(this.storage,this.storageKey+"-user"),await cr(this.storage,this.storageKey,n)):n.user=on()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const i=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<rn;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${rn}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:o}=await this._callRefreshToken(n.refresh_token);o&&(console.error(o),sn(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(n.access_token);!a&&(o!=null&&o.user)?(n.user=o.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var r,s;if(!e)throw new Ue;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new qs;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Ue;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={data:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(n,"error",i),N(i)){const o={data:null,error:i};return sn(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,r,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,r)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await _e(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},e),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await cr(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const i=ro(n);await cr(this.storage,this.storageKey,i)}else{const n=ro(r);await cr(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await _e(this.storage,this.storageKey),await _e(this.storage,this.storageKey+"-code-verifier"),await _e(this.storage,this.storageKey+"-user"),this.userStorage&&await _e(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ye()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),lr);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/lr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${lr}ms, refresh threshold is ${xn} ticks`),n<=xn&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof $a)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ye()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,s){const n=[`provider=${encodeURIComponent(r)}`];if(s!=null&&s.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,o]=await er(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});n.push(a.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);n.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;return i?this._returnResult({data:null,error:i}):await B(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(N(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var s,n;const{data:i,error:o}=r;if(o)return this._returnResult({data:null,error:o});const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:l,error:c}=await B(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return c?this._returnResult({data:null,error:c}):(e.factorType==="totp"&&l.type==="totp"&&(!((n=l==null?void 0:l.totp)===null||n===void 0)&&n.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(r){if(N(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?cd(e.webauthn.credential_response):ud(e.webauthn.credential_response)})}:{code:e.code}),{data:a,error:l}=await B(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),this._returnResult({data:a,error:l}))})}catch(r){if(N(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=await B(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});if(o.error)return o;const{data:a}=o;if(a.type!=="webauthn")return{data:a,error:null};switch(a.webauthn.type){case"create":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:ad(a.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:ld(a.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(N(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const n={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=r==null?void 0:r.factors)!==null&&e!==void 0?e:[])n.all.push(i),i.status==="verified"&&n[i.factor_type].push(i);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:s},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=nn(s.access_token);let o=null;i.aal&&(o=i.aal);let a=o;((r=(e=s.user.factors)===null||e===void 0?void 0:e.filter(u=>u.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(a="aal2");const c=i.amr||[];return{data:{currentLevel:o,nextLevel:a,currentAuthenticationMethods:c},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?await B(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Ue})})}catch(r){if(N(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async s=>{const{data:{session:n},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!n)return this._returnResult({data:null,error:new Ue});const o=await B(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:a=>({data:a,error:null})});return o.data&&o.data.redirect_url&&ye()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(s){if(N(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,r){try{return await this._useSession(async s=>{const{data:{session:n},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!n)return this._returnResult({data:null,error:new Ue});const o=await B(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:a=>({data:a,error:null})});return o.data&&o.data.redirect_url&&ye()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(s){if(N(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;return s?this._returnResult({data:null,error:s}):r?await B(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new Ue})})}catch(e){if(N(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?(await B(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Ue})})}catch(r){if(N(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,r={keys:[]}){let s=r.keys.find(a=>a.kid===e);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(a=>a.kid===e),s&&this.jwks_cached_at+mh>n)return s;const{data:i,error:o}=await B(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=n,s=i.keys.find(a=>a.kid===e),!s)?null:s}async getClaims(e,r={}){try{let s=e;if(!s){const{data:d,error:v}=await this.getSession();if(v||!d.session)return this._returnResult({data:null,error:v});s=d.session.access_token}const{header:n,payload:i,signature:o,raw:{header:a,payload:l}}=nn(s);r!=null&&r.allowExpired||Mh(i.exp);const c=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:d}=await this.getUser(s);if(d)throw d;return{data:{claims:i,header:n,signature:o},error:null}}const u=qh(n.alg),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,Ah(`${a}.${l}`)))throw new Pn("Invalid JWT signature");return{data:{claims:i,header:n,signature:o},error:null}}catch(s){if(N(s))return this._returnResult({data:null,error:s});throw s}}}Gr.nextInstanceID={};const _d=Gr,yd="2.89.0";let Or="";typeof Deno<"u"?Or="deno":typeof document<"u"?Or="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Or="react-native":Or="node";const bd={"X-Client-Info":`supabase-js-${Or}/${yd}`},Sd={headers:bd},Ed={schema:"public"},kd={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Td={};function zr(t){"@babel/helpers - typeof";return zr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zr(t)}function Rd(t,e){if(zr(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,e);if(zr(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ad(t){var e=Rd(t,"string");return zr(e)=="symbol"?e:e+""}function Od(t,e,r){return(e=Ad(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function co(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function he(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?co(Object(r),!0).forEach(function(s){Od(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):co(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}const xd=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Cd=()=>Headers,Id=(t,e,r)=>{const s=xd(r),n=Cd();return async(i,o)=>{var a;const l=(a=await e())!==null&&a!==void 0?a:t;let c=new n(o==null?void 0:o.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),s(i,he(he({},o),{},{headers:c}))}};function Pd(t){return t.endsWith("/")?t:t+"/"}function $d(t,e){var r,s;const{db:n,auth:i,realtime:o,global:a}=t,{db:l,auth:c,realtime:u,global:h}=e,p={db:he(he({},l),n),auth:he(he({},c),i),realtime:he(he({},u),o),storage:{},global:he(he(he({},h),a),{},{headers:he(he({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(s=a==null?void 0:a.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return t.accessToken?p.accessToken=t.accessToken:delete p.accessToken,p}function jd(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Pd(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var Ud=class extends _d{constructor(t){super(t)}},Nd=class{constructor(t,e,r){var s,n;this.supabaseUrl=t,this.supabaseKey=e;const i=jd(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const o=`sb-${i.hostname.split(".")[0]}-auth-token`,a={db:Ed,realtime:Td,auth:he(he({},kd),{},{storageKey:o}),global:Sd},l=$d(r??{},a);if(this.storageKey=(s=l.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(n=l.global.headers)!==null&&n!==void 0?n:{},l.accessToken)this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(u,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}});else{var c;this.auth=this._initSupabaseAuthClient((c=l.auth)!==null&&c!==void 0?c:{},this.headers,l.global.fetch)}this.fetch=Id(e,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(he({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&this.accessToken().then(u=>this.realtime.setAuth(u)).catch(u=>console.warn("Failed to set initial Realtime auth token:",u)),this.rest=new gu(new URL("rest/v1",i).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new dh(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new uu(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,r)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,r;if(t.accessToken)return await t.accessToken();const{data:s}=await t.auth.getSession();return(e=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:s,userStorage:n,storageKey:i,flowType:o,lock:a,debug:l,throwOnError:c},u,h){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Ud({url:this.authUrl.href,headers:he(he({},p),u),storageKey:i,autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:s,userStorage:n,flowType:o,lock:a,debug:l,throwOnError:c,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(d=>d.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new Pu(this.realtimeUrl.href,he(he({},t),{},{params:he(he({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(t,e,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const Dd=(t,e,r)=>new Nd(t,e,r);function Ld(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}Ld()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Bd="https://piwusiuwfglawswjxmlv.supabase.co",Md="sb_publishable_j3Vg23hYBUHWw4oNo9dhrw_xWOSSikK";let ln=null;const Ne=()=>(ln||(ln=Dd(Bd,Md)),ln),Na="lecture-qna-store",fe=()=>{const t=localStorage.getItem(Na);if(!t)return{rooms:[],questions:[],profiles:{},users:[],memberships:[],questionReactions:[],answerReactions:[],currentUserId:void 0};try{const e=JSON.parse(t),r=e.profiles??{};return e.profile&&e.currentUserId&&!r[e.currentUserId]&&(r[e.currentUserId]=e.profile),{rooms:e.rooms??[],questions:e.questions??[],profiles:r,users:e.users??[],memberships:e.memberships??[],questionReactions:e.questionReactions??[],answerReactions:e.answerReactions??[],currentUserId:e.currentUserId}}catch{return{rooms:[],questions:[],profiles:{},users:[],memberships:[],questionReactions:[],answerReactions:[],currentUserId:void 0}}},Se=t=>{localStorage.setItem(Na,JSON.stringify(t))},cs=()=>crypto.randomUUID(),qd=t=>Math.floor(t),Fd=t=>t>=12?3:t>=7?2:t>=3?1:0,nr=()=>({like:0,thanks:0}),cn=()=>[],Re={setCurrentUserId(t){const e=fe();e.currentUserId=t,t&&!e.profiles[t]&&(e.profiles[t]={xp:0,level:0,avatarStage:0}),Se(e)},async registerUser(t,e,r,s){const n=fe(),i=n.users.find(c=>c.email.toLowerCase()===r.toLowerCase());if(i){n.currentUserId=i.id,n.profiles[i.id]||(n.profiles[i.id]={xp:0,level:0,avatarStage:0}),Se(n);const{password:c,...u}=i;return u}const o={id:cs(),name:t,role:e,email:r,password:s,avatarUrl:void 0};n.users.push(o),n.currentUserId=o.id,n.profiles[o.id]={xp:0,level:0,avatarStage:0},Se(n);const{password:a,...l}=o;return l},async loginUser(t,e){const r=fe(),s=r.users.find(o=>o.email.toLowerCase()===t.toLowerCase());if(!s||s.password!==e)return null;r.currentUserId=s.id,r.profiles[s.id]||(r.profiles[s.id]={xp:0,level:0,avatarStage:0}),Se(r);const{password:n,...i}=s;return i},async logoutUser(){const t=fe();t.currentUserId=void 0,Se(t)},async getCurrentUser(){const t=fe();if(!t.currentUserId)return null;const e=t.users.find(n=>n.id===t.currentUserId);if(!e)return null;const{password:r,...s}=e;return s},async updateAvatar(t){const e=fe();if(!e.currentUserId)throw new Error("");const r=e.users.findIndex(i=>i.id===e.currentUserId);if(r===-1)throw new Error("");e.users[r]={...e.users[r],avatarUrl:t},Se(e);const{password:s,...n}=e.users[r];return n},async listUserAvatars(t){const e=fe(),r={};for(const s of t){const n=e.users.find(i=>i.id===s);n!=null&&n.avatarUrl&&(r[s]=n.avatarUrl)}return r},async listJoinedRooms(){const t=fe();if(!t.currentUserId)return[];const e=new Set(t.memberships.filter(r=>r.userId===t.currentUserId).map(r=>r.roomId));return t.rooms.filter(r=>e.has(r.id))},async createRoom(t,e,r){const s=fe(),n={id:cs(),code:Math.random().toString(36).slice(2,8).toUpperCase(),name:t,channel:e,taKey:r,createdAt:new Date().toISOString()};return s.rooms.unshift(n),s.currentUserId&&s.memberships.unshift({userId:s.currentUserId,roomId:n.id,joinedAt:new Date().toISOString()}),Se(s),n},async joinRoom(t){const e=fe(),r=e.rooms.find(s=>s.code===t)??null;return r&&e.currentUserId&&(e.memberships.some(n=>n.userId===e.currentUserId&&n.roomId===r.id)||(e.memberships.unshift({userId:e.currentUserId,roomId:r.id,joinedAt:new Date().toISOString()}),Se(e))),r},async listQuestions(t){return fe().questions.filter(r=>r.roomId===t).map(r=>({...r,reactions:r.reactions??nr(),answers:(r.answers??cn()).map(s=>({...s,reactions:s.reactions??nr()}))}))},async createQuestion(t,e,r,s,n){const i=fe(),o={id:cs(),roomId:t,text:e,status:"open",createdAt:new Date().toISOString(),ownerId:n,author:r,anonymous:s,reactions:nr(),answers:cn()};return i.questions.unshift(o),Se(i),o},async createAnswer(t,e,r,s,n){const i=fe(),o=i.questions.find(l=>l.id===t);if(!o)throw new Error("");const a={id:cs(),questionId:t,text:e,author:r,role:s,createdAt:new Date().toISOString(),reactions:nr(),ownerId:n};return o.answers||(o.answers=cn()),o.answers.push(a),Se(i),a},async addQuestionReaction(t,e,r){const s=fe(),n=s.questions.find(o=>o.id===t);if(!n)return null;n.reactions||(n.reactions=nr());const i=s.questionReactions.findIndex(o=>o.questionId===t&&o.userId===r&&o.type===e);return i>=0?(s.questionReactions.splice(i,1),n.reactions[e]=Math.max(0,n.reactions[e]-1)):(n.reactions[e]+=1,s.questionReactions.push({questionId:t,userId:r,type:e})),Se(s),n},async addAnswerReaction(t,e,r){var i;const s=fe(),n=s.answerReactions.findIndex(o=>o.answerId===t&&o.userId===r&&o.type===e);for(const o of s.questions){const a=(i=o.answers)==null?void 0:i.find(l=>l.id===t);if(a)return a.reactions||(a.reactions=nr()),n>=0?(s.answerReactions.splice(n,1),a.reactions[e]=Math.max(0,a.reactions[e]-1)):(a.reactions[e]+=1,s.answerReactions.push({answerId:t,userId:r,type:e})),Se(s),a}return null},async updateQuestionStatus(t,e){const r=fe(),s=r.questions.find(n=>n.id===t);return s?(s.status=e,Se(r),s):null},async deleteQuestion(t){var n;const e=fe(),r=e.questions.findIndex(i=>i.id===t);if(r===-1)return!1;const[s]=e.questions.splice(r,1);if(e.questionReactions=e.questionReactions.filter(i=>i.questionId!==t),(n=s==null?void 0:s.answers)!=null&&n.length){const i=new Set(s.answers.map(o=>o.id));e.answerReactions=e.answerReactions.filter(o=>!i.has(o.answerId))}return Se(e),!0},async deleteAnswer(t){var r,s;const e=fe();for(const n of e.questions){const i=(r=n.answers)==null?void 0:r.findIndex(o=>o.id===t);if(!(i===void 0||i<0))return(s=n.answers)==null||s.splice(i,1),e.answerReactions=e.answerReactions.filter(o=>o.answerId!==t),Se(e),!0}return!1},async getProfile(){const t=fe();return t.currentUserId?t.profiles[t.currentUserId]??{xp:0,level:0,avatarStage:0}:{xp:0,level:0,avatarStage:0}},async addXp(t){const e=fe();if(!e.currentUserId)return{xp:0,level:0,avatarStage:0};const r=e.profiles[e.currentUserId]??{xp:0,level:0,avatarStage:0};return r.xp=Math.max(0,r.xp+t),r.level=qd(r.xp),r.avatarStage=Fd(r.level),e.profiles[e.currentUserId]=r,Se(e),r}},Lt=()=>{const t=Ne();if(!t)throw new Error("Supabase ENV ");return t},uo=t=>Math.floor(t),ho=t=>t>=12?3:t>=7?2:t>=3?1:0,un=t=>({id:t.id,code:t.code,name:t.name,channel:t.channel,taKey:t.ta_key??t.taKey??void 0,createdAt:t.created_at}),vs=t=>({id:t.id,questionId:t.question_id,text:t.text,author:t.author,role:t.role,createdAt:t.created_at,reactions:t.reactions??{like:0,thanks:0},ownerId:t.owner_id??void 0}),us=t=>({id:t.id,roomId:t.room_id,text:t.text,status:t.status,createdAt:t.created_at,ownerId:t.owner_id??void 0,author:t.author,anonymous:t.anonymous??!1,reactions:t.reactions??{like:0,thanks:0},answers:(t.answers??[]).map(vs).sort((e,r)=>e.createdAt.localeCompare(r.createdAt))}),te={async registerUser(t,e,r,s){const n=Lt(),{data:i,error:o}=await n.auth.signUp({email:r,password:s,options:{data:{display_name:t,role:e}}});if(o||!i.user)throw new Error((o==null?void 0:o.message)??"Failed to register");const a={id:i.user.id,display_name:t,role:e,xp:0,level:0},{error:l}=await n.from("profiles").upsert(a);if(l)throw new Error(l.message);return Re.setCurrentUserId(i.user.id),{id:i.user.id,name:t,role:e,email:r}},async loginUser(t,e){const r=Lt(),{data:s,error:n}=await r.auth.signInWithPassword({email:t,password:e});if(n||!s.user)return null;const{data:i,error:o}=await r.from("profiles").select("*").eq("id",s.user.id).maybeSingle();if(o||!i)throw new Error((o==null?void 0:o.message)??"");return Re.setCurrentUserId(s.user.id),{id:s.user.id,name:i.display_name,role:i.role,email:t,avatarUrl:i.avatar_url??void 0}},async logoutUser(){const t=Lt(),{error:e}=await t.auth.signOut();if(e)throw new Error(e.message);Re.setCurrentUserId(void 0)},async getCurrentUser(){const t=Ne();if(!t)return null;const{data:e,error:r}=await t.auth.getUser();if(r||!e.user)return null;const{data:s,error:n}=await t.from("profiles").select("*").eq("id",e.user.id).maybeSingle();return n||!s?null:(Re.setCurrentUserId(e.user.id),{id:e.user.id,name:s.display_name,role:s.role,email:e.user.email??"",avatarUrl:s.avatar_url??void 0})},async listJoinedRooms(){const t=Lt(),{data:e,error:r}=await t.auth.getUser();if(r||!e.user)return[];const{data:s,error:n}=await t.from("room_members").select("room:rooms(*)").eq("user_id",e.user.id).order("joined_at",{ascending:!1});if(n||!s)throw new Error((n==null?void 0:n.message)??"Failed to load rooms");return s.map(i=>i.room).filter(Boolean).map(un)},async createRoom(t,e,r){const s=Lt(),{data:n,error:i}=await s.auth.getUser();if(i||!n.user)throw new Error("");const o={name:t,channel:e};r&&(o.ta_key=r),o.created_by=n.user.id;const{data:a,error:l}=await s.from("rooms").insert([o]).select().single();if(l||!a)throw new Error((l==null?void 0:l.message)??"Failed to create room");const{error:c}=await s.from("room_members").upsert({room_id:a.id,user_id:n.user.id},{onConflict:"room_id,user_id",ignoreDuplicates:!0});if(c)throw new Error(c.message);return un(a)},async joinRoom(t){const e=Lt(),{data:r,error:s}=await e.from("rooms").select("*").eq("code",t).maybeSingle();if(s)throw new Error(s.message);if(r){const{data:n}=await e.auth.getUser();if(n.user){const{error:i}=await e.from("room_members").upsert({room_id:r.id,user_id:n.user.id},{onConflict:"room_id,user_id",ignoreDuplicates:!0});if(i)throw new Error(i.message)}}return r?un(r):null},async listQuestions(t){const e=Ne();if(!e)return Re.listQuestions(t);const{data:r,error:s}=await e.from("questions").select("*, answers(*)").eq("room_id",t).order("created_at",{ascending:!1});if(s||!r)throw new Error((s==null?void 0:s.message)??"Failed to load questions");const n=r.map(l=>l.id),i=r.flatMap(l=>(l.answers??[]).map(c=>c.id)),o=new Map,a=new Map;if(n.length){const{data:l,error:c}=await e.from("question_reactions").select("question_id, type").in("question_id",n);if(c)throw new Error(c.message);for(const u of l??[]){const h=o.get(u.question_id)??{like:0,thanks:0};h[u.type]+=1,o.set(u.question_id,h)}}if(i.length){const{data:l,error:c}=await e.from("answer_reactions").select("answer_id, type").in("answer_id",i);if(c)throw new Error(c.message);for(const u of l??[]){const h=a.get(u.answer_id)??{like:0,thanks:0};h[u.type]+=1,a.set(u.answer_id,h)}}return r.map(l=>{const c=us(l);return c.reactions=o.get(c.id)??{like:0,thanks:0},c.answers=c.answers.map(u=>({...u,reactions:a.get(u.id)??{like:0,thanks:0}})),c})},async createQuestion(t,e,r,s,n){var c;const i=Ne();if(!i)return Re.createQuestion(t,e,r,s,n);let o=n;if(!o){const{data:u}=await i.auth.getUser();o=(c=u.user)==null?void 0:c.id}const{data:a,error:l}=await i.from("questions").insert([{room_id:t,text:e,author:r,anonymous:s,owner_id:o}]).select().single();if(l||!a)throw new Error((l==null?void 0:l.message)??"Failed to create question");return{...us(a),answers:[]}},async createAnswer(t,e,r,s,n){const i=Ne();if(!i)return Re.createAnswer(t,e,r,s,n);const{data:o,error:a}=await i.from("answers").insert([{question_id:t,text:e,author:r,role:s,owner_id:n}]).select().single();if(a&&(a.code==="42703"||a.code==="PGRST204"||a.message.includes("schema cache"))){const{data:l,error:c}=await i.from("answers").insert([{question_id:t,text:e,author:r,role:s}]).select().single();if(c||!l)throw new Error((c==null?void 0:c.message)??"Failed to create answer");return{...vs(l),reactions:{like:0,thanks:0}}}if(a||!o)throw new Error((a==null?void 0:a.message)??"Failed to create answer");return{...vs(o),reactions:{like:0,thanks:0}}},async updateQuestionStatus(t,e){const r=Ne();if(!r)return Re.updateQuestionStatus(t,e);const{data:s,error:n}=await r.from("questions").update({status:e}).eq("id",t).select("*, answers(*)").maybeSingle();if(n)throw new Error(n.message);return s?us(s):null},async addQuestionReaction(t,e,r){const s=Ne();if(!s)return Re.addQuestionReaction(t,e,r);const{data:n,error:i}=await s.from("question_reactions").select("id").eq("question_id",t).eq("user_id",r).eq("type",e).maybeSingle();if(i)throw new Error(i.message);if(n){const{error:p}=await s.from("question_reactions").delete().eq("id",n.id);if(p)throw new Error(p.message)}else{const{error:p}=await s.from("question_reactions").insert([{question_id:t,user_id:r,type:e}]);if(p)throw new Error(p.message)}const{data:o,error:a}=await s.from("questions").select("*, answers(*)").eq("id",t).maybeSingle();if(a)throw new Error(a.message);if(!o)return null;const{data:l,error:c}=await s.from("question_reactions").select("type").eq("question_id",t);if(c)throw new Error(c.message);const u={like:0,thanks:0};for(const p of l??[])u[p.type]+=1;const h=us(o);return h.reactions=u,h},async addAnswerReaction(t,e,r){const s=Ne();if(!s)return Re.addAnswerReaction(t,e,r);const{data:n,error:i}=await s.from("answer_reactions").select("id").eq("answer_id",t).eq("user_id",r).eq("type",e).maybeSingle();if(i)throw new Error(i.message);if(n){const{error:h}=await s.from("answer_reactions").delete().eq("id",n.id);if(h)throw new Error(h.message)}else{const{error:h}=await s.from("answer_reactions").insert([{answer_id:t,user_id:r,type:e}]);if(h)throw new Error(h.message)}const{data:o,error:a}=await s.from("answers").select("*").eq("id",t).maybeSingle();if(a)throw new Error(a.message);if(!o)return null;const{data:l,error:c}=await s.from("answer_reactions").select("type").eq("answer_id",t);if(c)throw new Error(c.message);const u={like:0,thanks:0};for(const h of l??[])u[h.type]+=1;return{...vs(o),reactions:u}},async deleteQuestion(t){const e=Ne();if(!e)return Re.deleteQuestion(t);const{data:r,error:s}=await e.from("questions").delete().eq("id",t).select("id");if(s)throw new Error(s.message);if(!r||r.length===0)throw new Error("");return!0},async deleteAnswer(t){const e=Ne();if(!e)return Re.deleteAnswer(t);const{data:r,error:s}=await e.from("answers").delete().eq("id",t).select("id");if(s)throw new Error(s.message);if(!r||r.length===0)throw new Error("");return!0},async getProfile(){const t=Ne();if(!t)return Re.getProfile();const{data:e,error:r}=await t.auth.getUser();if(r||!e.user)return{xp:0,level:0,avatarStage:0};const{data:s,error:n}=await t.from("profiles").select("xp, level").eq("id",e.user.id).maybeSingle();if(n||!s)return{xp:0,level:0,avatarStage:0};const i=s.xp??0,o=s.level??uo(i);return{xp:i,level:o,avatarStage:ho(o)}},async addXp(t){const e=Ne();if(!e)return Re.addXp(t);const{data:r,error:s}=await e.auth.getUser();if(s||!r.user)return{xp:0,level:0,avatarStage:0};const{data:n,error:i}=await e.from("profiles").select("xp, level").eq("id",r.user.id).maybeSingle();if(i)throw new Error(i.message);const o=(n==null?void 0:n.xp)??0,a=Math.max(0,o+t),l=uo(a),{error:c}=await e.from("profiles").update({xp:a,level:l}).eq("id",r.user.id);if(c)throw new Error(c.message);return{xp:a,level:l,avatarStage:ho(l)}},async updateAvatar(t){const e=Lt(),{data:r,error:s}=await e.auth.getUser();if(s||!r.user)throw new Error("");const{data:n,error:i}=await e.from("profiles").update({avatar_url:t}).eq("id",r.user.id).select("*").single();if(i||!n)throw new Error((i==null?void 0:i.message)??"");return{id:n.id,name:n.display_name,role:n.role,email:r.user.email??"",avatarUrl:n.avatar_url??void 0}},async listUserAvatars(t){if(!t.length)return{};const e=Ne();if(!e)return Re.listUserAvatars(t);const{data:r,error:s}=await e.from("profiles").select("id, avatar_url").in("id",t);if(s||!r)throw new Error((s==null?void 0:s.message)??"");const n={};for(const i of r)i.avatar_url&&(n[i.id]=i.avatar_url);return n}},Kd={class:"card"},Vd={class:"mode-toggle"},Wd={key:0},Hd={key:1},Jd={class:"primary",type:"submit"},Gd=Jt({__name:"AuthPanel",emits:["login","register"],setup(t,{emit:e}){const r=e,s=ce("login"),n=ce(""),i=ce(""),o=ce(""),a=ce("student"),l=()=>{const c=i.value.trim(),u=o.value.trim();if(!(!c||!u))if(s.value==="login")r("login",{email:c,password:u});else{const h=n.value.trim();if(!h)return;r("register",{name:h,role:a.value,email:c,password:u})}};return(c,u)=>(K(),H("section",Kd,[u[11]||(u[11]=m("div",{class:"card-header"},[m("p",{class:"eyebrow"},"Account"),m("h2",null,""),m("p",{class:"sub"},"")],-1)),m("div",Vd,[m("button",{class:Je({active:s.value==="login"}),onClick:u[0]||(u[0]=h=>s.value="login")},"",2),m("button",{class:Je({active:s.value==="register"}),onClick:u[1]||(u[1]=h=>s.value="register")},"  ",2)]),m("form",{class:"form",onSubmit:Ls(l,["prevent"])},[s.value==="register"?(K(),H("label",Wd,[u[6]||(u[6]=m("span",null,"",-1)),Me(m("input",{"onUpdate:modelValue":u[2]||(u[2]=h=>n.value=h),type:"text",placeholder:": Yuki"},null,512),[[ot,n.value]])])):we("",!0),m("label",null,[u[7]||(u[7]=m("span",null,"",-1)),Me(m("input",{"onUpdate:modelValue":u[3]||(u[3]=h=>i.value=h),type:"email",placeholder:"you@example.com"},null,512),[[ot,i.value]])]),s.value==="register"?(K(),H("label",Hd,[u[9]||(u[9]=m("span",null,"",-1)),Me(m("select",{"onUpdate:modelValue":u[4]||(u[4]=h=>a.value=h)},[...u[8]||(u[8]=[m("option",{value:"student"},"",-1),m("option",{value:"teacher"},"",-1)])],512),[[Zc,a.value]])])):we("",!0),m("label",null,[u[10]||(u[10]=m("span",null,"",-1)),Me(m("input",{"onUpdate:modelValue":u[5]||(u[5]=h=>o.value=h),type:"password",placeholder:"8"},null,512),[[ot,o.value]])]),m("button",Jd,re(s.value==="login"?"":""),1)],32)]))}}),br=(t,e)=>{const r=t.__vccOpts||t;for(const[s,n]of e)r[s]=n;return r},zd=br(Gd,[["__scopeId","data-v-089b5381"]]),Qd={class:"card"},Yd=Jt({__name:"RoomCreate",emits:["create"],setup(t,{emit:e}){const r=e,s=ce(""),n=ce(""),i=ce(""),o=()=>{s.value.trim()&&r("create",{name:s.value.trim(),channel:n.value.trim(),taKey:i.value.trim()||void 0})};return(a,l)=>(K(),H("section",Qd,[l[8]||(l[8]=m("div",{class:"card-header"},[m("p",{class:"eyebrow"},"Teacher Console"),m("h2",null,""),m("p",{class:"sub"},"")],-1)),m("form",{class:"form",onSubmit:Ls(o,["prevent"])},[m("label",null,[l[3]||(l[3]=m("span",null,"",-1)),Me(m("input",{"onUpdate:modelValue":l[0]||(l[0]=c=>s.value=c),type:"text",placeholder:": "},null,512),[[ot,s.value]])]),m("label",null,[l[4]||(l[4]=m("span",null," ()",-1)),Me(m("input",{"onUpdate:modelValue":l[1]||(l[1]=c=>n.value=c),type:"text",placeholder:": 2 / "},null,512),[[ot,n.value]])]),m("label",null,[l[5]||(l[5]=m("span",null,"TA ()",-1)),Me(m("input",{"onUpdate:modelValue":l[2]||(l[2]=c=>i.value=c),type:"text",placeholder:": TA-2024"},null,512),[[ot,i.value]])]),l[6]||(l[6]=m("button",{class:"primary",type:"submit"},"",-1)),l[7]||(l[7]=m("p",{class:"hint"},"",-1))],32)]))}}),Xd=br(Yd,[["__scopeId","data-v-40f38f01"]]),Zd={class:"card"},ef={key:0},tf={class:"hint"},rf=Jt({__name:"RoomJoin",props:{role:{}},emits:["join"],setup(t,{emit:e}){const r=t,s=e,n=ce(""),i=ce(""),o=l=>{try{const u=new URL(l).searchParams.get("room");return u?u.toUpperCase():l.toUpperCase()}catch{return l.toUpperCase()}},a=()=>{const l=o(n.value.trim());l&&s("join",{code:l,taKey:i.value.trim()||void 0})};return(l,c)=>(K(),H("section",Zd,[c[5]||(c[5]=m("div",{class:"card-header"},[m("p",{class:"eyebrow"},"Student Entry"),m("h2",null,""),m("p",{class:"sub"},"QRURL")],-1)),m("form",{class:"form",onSubmit:Ls(a,["prevent"])},[m("label",null,[c[2]||(c[2]=m("span",null," / URL",-1)),Me(m("input",{"onUpdate:modelValue":c[0]||(c[0]=u=>n.value=u),type:"text",placeholder:": X7K9Q2  https://..."},null,512),[[ot,n.value]])]),r.role==="ta"?(K(),H("label",ef,[c[3]||(c[3]=m("span",null,"TA",-1)),Me(m("input",{"onUpdate:modelValue":c[1]||(c[1]=u=>i.value=u),type:"text",placeholder:""},null,512),[[ot,i.value]])])):we("",!0),c[4]||(c[4]=m("button",{class:"primary",type:"submit"},"",-1)),m("p",tf,re(r.role==="ta"?"TA":""),1)],32)]))}}),sf=br(rf,[["__scopeId","data-v-6ebe36c9"]]),nf={class:"card"},of={key:0,class:"room-list"},af=["onClick"],lf={class:"room-name"},cf={class:"room-meta"},uf={key:0},hf={key:1,class:"empty"},df=Jt({__name:"RoomHistory",props:{rooms:{}},emits:["open"],setup(t,{emit:e}){const r=t,s=e;return(n,i)=>(K(),H("section",nf,[i[2]||(i[2]=m("div",{class:"card-header"},[m("p",{class:"eyebrow"},"History"),m("h2",null,""),m("p",{class:"sub"},"")],-1)),r.rooms.length?(K(),H("div",of,[(K(!0),H(xe,null,bs(r.rooms,o=>(K(),H("button",{key:o.id,class:"room-item",type:"button",onClick:a=>s("open",o)},[m("div",null,[m("p",lf,re(o.name),1),m("p",cf,[Yn(" Code: "+re(o.code)+" ",1),o.channel?(K(),H("span",uf,"/ "+re(o.channel),1)):we("",!0)])]),i[0]||(i[0]=m("span",{class:"enter"},"",-1))],8,af))),128))])):(K(),H("div",hf,[...i[1]||(i[1]=[m("p",null,"",-1)])]))]))}}),ff=br(df,[["__scopeId","data-v-6c842f2e"]]),pf={class:"list"},gf={class:"meta"},vf={class:"time"},mf={class:"author-block"},wf={class:"author-info"},_f={class:"avatar-inner"},yf=["src"],bf={key:1,class:"author"},Sf={key:2,class:"author"},Ef={key:3,class:"author"},kf={class:"tabs"},Tf=["onClick"],Rf={class:"text"},Af={class:"footer"},Of=["onClick"],xf=["onClick"],Cf=["onClick"],If=["onClick"],Pf=["onClick"],$f=["onClick"],jf=["onClick"],Uf={key:0},Nf={key:0,class:"answers"},Df={class:"answer-meta"},Lf={class:"avatar-inner"},Bf=["src"],Mf={class:"answer-author"},qf={class:"answer-role"},Ff={class:"time"},Kf={class:"answer-text"},Vf={class:"answer-actions"},Wf=["onClick"],Hf=["onClick"],Jf=["onClick"],Gf={key:1,class:"empty-answers"},zf={class:"reply"},Qf=["onUpdate:modelValue"],Yf=["onClick"],Xf={class:"reply-anon"},Zf=["onUpdate:modelValue"],ep={key:0,class:"empty"},tp=Jt({__name:"QuestionList",props:{role:{},questions:{},currentUserId:{},userAvatars:{},currentUserLevel:{}},emits:["resolve","reopen","react","react-answer","reply","delete-question","delete-answer"],setup(t,{emit:e}){const r=t,s=e,n=y=>y==="resolved"?"":"",i=ce({}),o=ce({}),a=ce({}),l=y=>y==="teacher"?"":y==="ta"?"TA":"",c=y=>r.role==="student"&&y.ownerId===r.currentUserId||r.role==="teacher"||r.role==="ta",u=y=>r.role==="student"&&y.ownerId===r.currentUserId||r.role==="teacher"||r.role==="ta",h=y=>{var k;return y.ownerId?(k=r.userAvatars)==null?void 0:k[y.ownerId]:void 0},p=y=>{var k;return y.ownerId?(k=r.userAvatars)==null?void 0:k[y.ownerId]:void 0},d=y=>{if(!y||y!==r.currentUserId)return"";const k=r.currentUserLevel??0;return k>=3?"frame-3":k>=2?"frame-2":k>=1?"frame-1":""},v=y=>{var w;const k=(w=i.value[y])==null?void 0:w.trim();k&&(s("reply",{questionId:y,text:k,anonymous:o.value[y]}),i.value[y]="",o.value[y]=!1)},b=y=>a.value[y]==="answers",O=y=>{a.value[y]=b(y)?"question":"answers"};return(y,k)=>(K(),H("div",pf,[(K(!0),H(xe,null,bs(t.questions,(w,A)=>(K(),H("div",{key:w.id,class:Je(["item",{resolved:w.status==="resolved"}]),style:Is({animationDelay:`${A*40}ms`})},[m("div",gf,[m("span",{class:Je(["badge",w.status])},re(n(w.status)),3),m("span",vf,re(new Date(w.createdAt).toLocaleTimeString()),1)]),m("div",mf,[m("div",wf,[!w.anonymous&&h(w)?(K(),H("div",{key:0,class:Je(["avatar-frame",d(w.ownerId)])},[m("div",_f,[m("img",{class:"author-avatar",src:h(w),alt:""},null,8,yf)])],2)):we("",!0),w.anonymous?(K(),H("span",bf,"")):w.author?(K(),H("span",Sf,re(w.author),1)):(K(),H("span",Ef,""))]),m("div",kf,[m("button",{class:Je(["tab",{active:b(w.id)}]),type:"button",onClick:x=>O(w.id)},"  "+re(w.answers.length),11,Tf)])]),m("p",Rf,re(w.text),1),m("div",Af,[m("button",{class:"reaction",onClick:x=>s("react",{questionId:w.id,type:"like"})},"  "+re(w.reactions.like),9,Of),m("button",{class:"reaction",onClick:x=>s("react",{questionId:w.id,type:"thanks"})},"  "+re(w.reactions.thanks),9,xf),t.role==="student"&&w.ownerId===r.currentUserId?(K(),H(xe,{key:0},[w.status==="open"?(K(),H("button",{key:0,class:"action ghost",onClick:x=>s("resolve",{questionId:w.id})},"  ",8,Cf)):(K(),H("button",{key:1,class:"action ghost",onClick:x=>s("reopen",{questionId:w.id})},"  ",8,If))],64)):we("",!0),c(w)?(K(),H("button",{key:1,class:"action danger",onClick:x=>s("delete-question",{questionId:w.id})},"  ",8,Pf)):we("",!0),(t.role==="teacher"||t.role==="ta")&&w.status==="open"?(K(),H("button",{key:2,class:"action",onClick:x=>s("resolve",{questionId:w.id})},"  ",8,$f)):we("",!0),(t.role==="teacher"||t.role==="ta")&&w.status==="resolved"?(K(),H("button",{key:3,class:"action ghost",onClick:x=>s("reopen",{questionId:w.id})},"  ",8,jf)):we("",!0)]),b(w.id)?(K(),H("div",Uf,[w.answers.length?(K(),H("div",Nf,[(K(!0),H(xe,null,bs(w.answers,x=>(K(),H("div",{key:x.id,class:"answer"},[m("div",Df,[x.author!==""&&p(x)?(K(),H("div",{key:0,class:Je(["avatar-frame",d(x.ownerId)])},[m("div",Lf,[m("img",{class:"answer-avatar",src:p(x),alt:""},null,8,Bf)])],2)):we("",!0),m("span",Mf,re(x.author||""),1),m("span",qf,re(l(x.role)),1),m("span",Ff,re(new Date(x.createdAt).toLocaleTimeString()),1)]),m("p",Kf,re(x.text),1),m("div",Vf,[m("button",{class:"reaction",onClick:J=>s("react-answer",{answerId:x.id,type:"like"})},"  "+re(x.reactions.like),9,Wf),m("button",{class:"reaction",onClick:J=>s("react-answer",{answerId:x.id,type:"thanks"})},"  "+re(x.reactions.thanks),9,Hf),u(x)?(K(),H("button",{key:0,class:"action danger",onClick:J=>s("delete-answer",{answerId:x.id})},"  ",8,Jf)):we("",!0)])]))),128))])):(K(),H("p",Gf,"")),m("div",zf,[Me(m("input",{"onUpdate:modelValue":x=>i.value[w.id]=x,type:"text",placeholder:""},null,8,Qf),[[ot,i.value[w.id]]]),m("button",{class:"reply-btn",type:"button",onClick:x=>v(w.id)},"  ",8,Yf)]),m("label",Xf,[Me(m("input",{"onUpdate:modelValue":x=>o.value[w.id]=x,type:"checkbox"},null,8,Zf),[[ma,o.value[w.id]]]),k[0]||(k[0]=Yn("  ",-1))])])):we("",!0)],6))),128)),t.questions.length===0?(K(),H("p",ep,"")):we("",!0)]))}}),rp=br(tp,[["__scopeId","data-v-5b06a79d"]]),sp={class:"room"},np={class:"room-header"},ip={key:0,class:"sub"},op={class:"stats"},ap={class:"stat"},lp={class:"stat"},cp={class:"stat"},up={class:"stat role"},hp={class:"grid"},dp={class:"panel"},fp={class:"panel-header"},pp={class:"helper"},gp={class:"helper-buttons"},vp=["onClick"],mp={class:"checkbox"},wp=["disabled"],_p={class:"panel list-panel"},yp=Jt({__name:"RoomView",props:{room:{},role:{},questions:{},profile:{},loading:{type:Boolean},currentUserId:{},userAvatars:{},currentUserLevel:{}},emits:["refresh","exit","submit","resolve","reopen","react","react-answer","reply","delete-question","delete-answer"],setup(t,{emit:e}){const r=t,s=e,n=ce(""),i=ce(!1),o=gr(()=>r.questions.filter(p=>p.status==="open").length),a=gr(()=>r.questions.filter(p=>p.status==="resolved").length),l=gr(()=>r.role==="teacher"?"":r.role==="ta"?"TA":""),c=()=>{n.value.trim()&&(s("submit",{text:n.value.trim(),anonymous:i.value}),n.value="")},u=[{label:"",value:""},{label:"",value:""},{label:"",value:""}],h=p=>{n.value=p};return(p,d)=>(K(),H("section",sp,[m("div",np,[m("div",null,[d[11]||(d[11]=m("p",{class:"eyebrow"},"Live Room",-1)),m("h2",null,re(t.room.name),1),d[12]||(d[12]=m("p",{class:"sub"},"",-1)),t.room.channel?(K(),H("p",ip,": "+re(t.room.channel),1)):we("",!0)]),m("button",{class:"ghost",onClick:d[0]||(d[0]=v=>s("exit"))},"")]),m("div",op,[m("div",ap,[d[13]||(d[13]=m("span",{class:"label"},"",-1)),m("strong",null,re(t.questions.length),1)]),m("div",lp,[d[14]||(d[14]=m("span",{class:"label"},"",-1)),m("strong",null,re(o.value),1)]),m("div",cp,[d[15]||(d[15]=m("span",{class:"label"},"",-1)),m("strong",null,re(a.value),1)]),m("div",up,[d[16]||(d[16]=m("span",{class:"label"},"",-1)),m("strong",null,re(l.value),1)])]),m("div",hp,[m("div",dp,[m("div",fp,[d[17]||(d[17]=m("h3",null,"",-1)),m("button",{class:"ghost",onClick:d[1]||(d[1]=v=>s("refresh"))},"")]),m("form",{class:"form",onSubmit:Ls(c,["prevent"])},[m("label",null,[d[18]||(d[18]=m("span",null,"",-1)),Me(m("textarea",{"onUpdate:modelValue":d[2]||(d[2]=v=>n.value=v),rows:"3",placeholder:""},null,512),[[ot,n.value]])]),m("div",pp,[d[19]||(d[19]=m("span",null,"",-1)),m("div",gp,[(K(),H(xe,null,bs(u,v=>m("button",{key:v.label,type:"button",class:"helper-btn",onClick:b=>h(v.value)},re(v.label),9,vp)),64))])]),m("label",mp,[Me(m("input",{"onUpdate:modelValue":d[3]||(d[3]=v=>i.value=v),type:"checkbox"},null,512),[[ma,i.value]]),d[20]||(d[20]=m("span",{class:"checkbox-text"}," ()",-1))]),m("button",{class:"primary",type:"submit",disabled:t.loading},"  ",8,wp)],32)])]),m("div",_p,[d[21]||(d[21]=m("div",{class:"panel-header"},[m("h3",null,""),m("p",{class:"sub"},"")],-1)),it(rp,{role:t.role,questions:t.questions,"current-user-id":t.currentUserId,"user-avatars":t.userAvatars,"current-user-level":t.currentUserLevel,onResolve:d[4]||(d[4]=v=>s("resolve",v)),onReopen:d[5]||(d[5]=v=>s("reopen",v)),onReact:d[6]||(d[6]=v=>s("react",v)),onReactAnswer:d[7]||(d[7]=v=>s("react-answer",v)),onReply:d[8]||(d[8]=v=>s("reply",v)),onDeleteQuestion:d[9]||(d[9]=v=>s("delete-question",v)),onDeleteAnswer:d[10]||(d[10]=v=>s("delete-answer",v))},null,8,["role","questions","current-user-id","user-avatars","current-user-level"])])]))}}),bp=br(yp,[["__scopeId","data-v-770f9110"]]),Sp={class:"page"},Ep={class:"content"},kp={key:1,class:"account-bar"},Tp={class:"account-left"},Rp={class:"account-avatar-inner"},Ap=["src"],Op={key:1,class:"account-avatar-placeholder"},xp={class:"account-name"},Cp={class:"account-actions"},Ip={key:0,class:"toast"},Pp=Jt({__name:"App",setup(t){const e=ce(null),r=gr(()=>{var P;return((P=e.value)==null?void 0:P.role)??"student"}),s=ce(null),n=ce([]),i=ce([]),o=ce({xp:0,level:0,avatarStage:0}),a=ce(!1),l=ce(null),c=ce(null),u=ce({}),h=ce(null),p=gr(()=>{var j;if(!((j=e.value)!=null&&j.avatarUrl))return"";const P=o.value.level??0;return P>=3?"frame-3":P>=2?"frame-2":P>=1?"frame-1":""}),d=P=>{l.value=P,P&&setTimeout(()=>{l.value===P&&(l.value=null)},4e3)},v=async P=>{a.value=!0;try{const j=await te.loginUser(P.email,P.password);if(!j){d("");return}if(e.value=j,i.value=await te.listJoinedRooms(),o.value=await te.getProfile(),c.value){const q=c.value;c.value=null,await A({code:q})}}catch(j){d(j.message)}finally{a.value=!1}},b=async P=>{a.value=!0;try{e.value=await te.registerUser(P.name,P.role,P.email,P.password),i.value=await te.listJoinedRooms(),o.value=await te.getProfile()}catch(j){d(j.message)}finally{a.value=!1}},O=async()=>{await te.logoutUser(),e.value=null,s.value=null,n.value=[],i.value=[]},y=()=>{var P;(P=h.value)==null||P.click()},k=P=>{var Qe;const j=P.target,q=(Qe=j.files)==null?void 0:Qe[0];if(j.value="",!q)return;if(!q.type.startsWith("image/")){d("");return}if(q.size>2*1024*1024){d("2MB");return}const z=new FileReader;z.onload=async()=>{const bt=z.result;if(typeof bt!="string"){d("");return}try{const Ye=await te.updateAvatar(bt);e.value=Ye,Ye.avatarUrl&&(u.value={...u.value,[Ye.id]:Ye.avatarUrl})}catch(Ye){d(Ye.message)}},z.readAsDataURL(q)},w=async P=>{a.value=!0;try{s.value=await te.createRoom(P.name,P.channel,P.taKey),i.value=await te.listJoinedRooms(),await x()}catch(j){d(j.message)}finally{a.value=!1}},A=async P=>{a.value=!0;try{const j=await te.joinRoom(P.code);if(!j){d("");return}if(r.value==="ta"&&j.taKey&&j.taKey!==P.taKey){d("TA");return}s.value=j,i.value=await te.listJoinedRooms(),await x()}catch(j){d(j.message)}finally{a.value=!1}},x=async P=>{if(s.value){P!=null&&P.silent||(a.value=!0);try{n.value=await te.listQuestions(s.value.id);const j=new Set;for(const q of n.value){q.ownerId&&j.add(q.ownerId);for(const z of q.answers)z.ownerId&&j.add(z.ownerId)}u.value=await te.listUserAvatars(Array.from(j))}catch(j){d(j.message)}finally{P!=null&&P.silent||(a.value=!1)}}},J=async P=>{var j,q;if(s.value){a.value=!0;try{const z=P.anonymous===!0,Qe=z?"":(j=e.value)==null?void 0:j.name;await te.createQuestion(s.value.id,P.text,Qe,z,(q=e.value)==null?void 0:q.id),r.value!=="teacher"&&(o.value=await te.addXp(1)),await x()}catch(z){d(z.message)}finally{a.value=!1}}},Q=async P=>{a.value=!0;try{await te.updateQuestionStatus(P.questionId,"resolved"),await x()}catch(j){d(j.message)}finally{a.value=!1}},ve=async P=>{a.value=!0;try{await te.updateQuestionStatus(P.questionId,"open"),await x()}catch(j){d(j.message)}finally{a.value=!1}},be=async P=>{try{if(!e.value){d("");return}const j=await te.addQuestionReaction(P.questionId,P.type,e.value.id);if(!j){await x({silent:!0});return}n.value=n.value.map(q=>q.id===j.id?{...q,reactions:j.reactions}:q),await x({silent:!0})}catch(j){d(j.message)}},ct=async P=>{try{if(!e.value){d("");return}const j=await te.addAnswerReaction(P.answerId,P.type,e.value.id);if(!j){await x({silent:!0});return}n.value=n.value.map(q=>({...q,answers:q.answers.map(z=>z.id===j.id?{...z,reactions:j.reactions}:z)})),await x({silent:!0})}catch(j){d(j.message)}},Pt=async P=>{var j,q,z,Qe;a.value=!0;try{const bt=P.anonymous?"":((j=e.value)==null?void 0:j.name)??"",Ye=((q=e.value)==null?void 0:q.role)??"student",$t=(z=e.value)==null?void 0:z.id,Qt=await te.createAnswer(P.questionId,P.text,bt,Ye,$t);e.value&&(o.value=await te.addXp(1)),(Qe=e.value)!=null&&Qe.avatarUrl&&e.value.id&&(u.value={...u.value,[e.value.id]:e.value.avatarUrl}),n.value=n.value.map(St=>St.id===P.questionId?{...St,answers:[...St.answers,Qt]}:St)}catch(bt){d(bt.message)}finally{a.value=!1}},Gt=async P=>{if(!confirm(""))return;const j=n.value.find(q=>q.id===P.questionId);a.value=!0;try{await te.deleteQuestion(P.questionId),j&&e.value&&j.ownerId===e.value.id&&(o.value=await te.addXp(-1)),await x()}catch(q){d(q.message)}finally{a.value=!1}},zt=async P=>{if(!confirm(""))return;const j=n.value.flatMap(q=>q.answers).find(q=>q.id===P.answerId);a.value=!0;try{await te.deleteAnswer(P.answerId),j&&e.value&&j.ownerId===e.value.id&&(o.value=await te.addXp(-1)),await x()}catch(q){d(q.message)}finally{a.value=!1}},Sr=()=>{s.value=null,n.value=[]},ts=async P=>{s.value=P,await x()};Go(()=>{te.getCurrentUser().then(q=>{if(e.value=q,q&&(te.listJoinedRooms().then(z=>{i.value=z}),c.value)){const z=c.value;c.value=null,A({code:z})}}),te.getProfile().then(q=>{o.value=q});const j=new URLSearchParams(window.location.search).get("room");j&&e.value?A({code:j.toUpperCase()}):j&&(c.value=j.toUpperCase())});let de=null;const le=()=>{de||(de=window.setInterval(()=>{s.value&&x({silent:!0})},5e3))},Z=()=>{de&&(window.clearInterval(de),de=null)};return fs(s,P=>{P?(x(),le()):Z()}),Gn(()=>{Z()}),(P,j)=>{var q;return K(),H("div",Sp,[j[1]||(j[1]=m("header",{class:"hero"},[m("div",null,[m("p",{class:"eyebrow"},"Lecture Interaction"),m("h1",null,"Lecture Q&A Pulse"),m("p",{class:"lead"},"  ")])],-1)),m("main",null,[m("section",Ep,[e.value?(K(),H("div",kp,[m("div",Tp,[m("div",{class:Je(["account-avatar",p.value])},[m("div",Rp,[e.value.avatarUrl?(K(),H("img",{key:0,src:e.value.avatarUrl,alt:""},null,8,Ap)):(K(),H("div",Op,"?"))])],2),m("div",null,[j[0]||(j[0]=m("p",{class:"eyebrow"},"Signed in",-1)),m("p",xp,re(e.value.name)+" / "+re(r.value==="teacher"?"":""),1)])]),m("div",Cp,[m("input",{ref_key:"avatarInput",ref:h,class:"sr-only",type:"file",accept:"image/*",onChange:k},null,544),m("button",{class:"ghost",onClick:y},""),m("button",{class:"ghost",onClick:O},"")])])):(K(),or(zd,{key:0,onLogin:v,onRegister:b})),e.value&&!s.value?(K(),or(ff,{key:2,rooms:i.value,onOpen:ts},null,8,["rooms"])):we("",!0),e.value&&r.value==="teacher"&&!s.value?(K(),or(Xd,{key:3,onCreate:w})):we("",!0),e.value&&!s.value?(K(),or(sf,{key:4,role:r.value,onJoin:A},null,8,["role"])):we("",!0),e.value&&s.value?(K(),or(bp,{key:5,room:s.value,role:r.value,questions:n.value,profile:o.value,loading:a.value,"current-user-id":(q=e.value)==null?void 0:q.id,"user-avatars":u.value,"current-user-level":o.value.level,onRefresh:x,onExit:Sr,onSubmit:J,onResolve:Q,onReopen:ve,onReact:be,onReactAnswer:ct,onReply:Pt,onDeleteQuestion:Gt,onDeleteAnswer:zt},null,8,["room","role","questions","profile","loading","current-user-id","user-avatars","current-user-level"])):we("",!0)])]),l.value?(K(),H("div",Ip,re(l.value),1)):we("",!0)])}}});nu(Pp).mount("#app");
